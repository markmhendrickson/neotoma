# Neotoma Environment Variables
# Copy this file to .env and fill in your actual values
# Never commit .env files to git

# =============================================================================
# Supabase Configuration (Required)
# =============================================================================
# Get these from: Supabase Dashboard → Settings → API
# Project ID: Settings → General → Project ID (or extract from Project URL)
# Service Role Key: Settings → API → service_role key (NOT anon key)

# Environment-based variables (preferred - set by 1Password sync based on ENVIRONMENT)
# The 1Password sync script will set these based on ENVIRONMENT=development or ENVIRONMENT=production
SUPABASE_PROJECT_ID=your-project-id
SUPABASE_SERVICE_KEY=your-service-role-key-here

# Alternative: Full URL (backward compatibility)
# SUPABASE_URL=https://your-project-id.supabase.co
# SUPABASE_SERVICE_KEY=your-service-role-key-here

# Supabase Access Token (for Management API - migrations, CLI operations)
# Get via: npx supabase login
# Or: Supabase Dashboard → Account → Access Tokens → Generate New Token
# SUPABASE_ACCESS_TOKEN=your-access-token-here

# =============================================================================
# Server Configuration
# =============================================================================
# MCP Server port (stdio mode)
PORT=3000

# HTTP Actions Server port
HTTP_PORT=8080

# Frontend URL for CORS configuration (defaults to http://localhost:5195)
# FRONTEND_URL=http://localhost:5195

# WebSocket MCP Bridge port
WS_PORT=8081

# Bearer token for HTTP Actions API authentication
# Environment-based (set by 1Password sync based on ENVIRONMENT)
# Development: Uses auth token (development) from Neotoma 1Password entry
# Production: Uses auth token (production) from Neotoma 1Password entry
ACTIONS_BEARER_TOKEN=your-actions-bearer-token-here

# MCP Server Authentication (Required for MCP connections)
# Option 1 (Recommended): OAuth connection ID
# Get from: Neotoma web UI → MCP Setup → OAuth Connection tab
# This is a long-lived connection that auto-refreshes tokens
NEOTOMA_CONNECTION_ID=your-connection-id-here

# Option 2 (Deprecated): Session token
# Get from: Neotoma web UI → MCP Setup → Session Token tab
# This is your Supabase access_token (JWT) - expires when you sign out
# NEOTOMA_SESSION_TOKEN=your-session-token-here

# MCP OAuth Token Encryption Key (Required for OAuth)
# Generate with: openssl rand -hex 32
# Keep this secret and never commit to git
MCP_TOKEN_ENCRYPTION_KEY=your-encryption-key-here

# API Base URL (for OAuth callbacks)
# API_BASE_URL=http://localhost:8080

# Supabase OAuth Client ID (Optional - automatic registration supported)
# Get from: Supabase Dashboard → Authentication → OAuth Server → Registered Clients
# If not set: Code will automatically register a client when "Allow Dynamic OAuth Apps" is enabled
# Manual registration takes precedence over automatic registration
# SUPABASE_OAUTH_CLIENT_ID=your-oauth-client-id-here

# =============================================================================
# OpenAI Configuration (Optional)
# =============================================================================
# Required for embeddings and AI features

# Environment-based variable (set by 1Password sync based on ENVIRONMENT)
OPENAI_API_KEY=sk-your-api-key-here

# =============================================================================
# Frontend Configuration (Vite - automatically loaded from .env)
# =============================================================================
# Vite automatically loads VITE_* variables from .env in all modes
# No need for separate .env.development - just use .env for everything

# Supabase configuration for frontend authentication (FU-700)
# Get anon key from: Supabase Dashboard → Settings → API → Project API keys → anon public
# URL is auto-generated from SUPABASE_PROJECT_ID above, or set manually:
VITE_SUPABASE_URL=https://your-project-id.supabase.co
VITE_SUPABASE_ANON_KEY=your-anon-key-here

# API Base URL for frontend API calls (defaults to http://localhost:8080)
# Required for MVP UI components (FU-301, FU-302, FU-303, FU-305, FU-601, FU-304)
VITE_API_BASE_URL=http://localhost:8080

# WebSocket port for frontend MCP connection (optional)
# VITE_WS_PORT=8081

# Local MCP WebSocket URL (optional, overrides default)
# VITE_LOCAL_MCP_URL=ws://127.0.0.1:8081/mcp

# MCP URL (optional, alternative to local)
# VITE_MCP_URL=ws://your-mcp-server.com/mcp

# Auto-seed records on startup (default: true, set to "false" to disable)
# VITE_AUTO_SEED_RECORDS=true

# =============================================================================
# Node Environment
# =============================================================================
# Set to "development", "test", or "production"
# NEOTOMA_ENV=development  # Preferred: Neotoma-specific env var (avoids conflicts when running as MCP)
# NODE_ENV=development     # Fallback: Standard Node.js convention (used if NEOTOMA_ENV not set)

# =============================================================================
# MCP WebSocket Bridge Configuration (Optional)
# =============================================================================
# Command to run MCP server (default: "node")
# MCP_CMD=node

# MCP server arguments (JSON array, default: ["dist/index.js"])
# MCP_ARGS=["dist/index.js"]

# =============================================================================
# Cursor Cloud API Configuration (Optional)
# =============================================================================
# Required for multi-agent orchestration features
# These are synced from 1Password (Cursor entry)

# Cursor Cloud API Key (synced from 1Password)
CURSOR_CLOUD_API_KEY=your-cursor-cloud-api-key-here

# Cursor Cloud API URL (can be hardcoded, defaults to https://api.cursor.com)
# Most scripts default to https://api.cursor.com if not set
# CURSOR_CLOUD_API_URL=https://api.cursor.com

# =============================================================================
# Testing Configuration (Optional)
# =============================================================================
# Disable auto-start of actions server in tests
# NEOTOMA_ACTIONS_DISABLE_AUTOSTART=0

# Branch ports file for test isolation
# BRANCH_PORTS_FILE=.branch-ports

