
> neotoma@0.2.15 test:integration
> vitest run tests/integration


[1m[46m RUN [49m[22m [36mv4.0.17 [39m[90m/Users/markmhendrickson/repos/neotoma[39m

[2m6:03:34 PM[22m [33m[1m[vite][22m[39m (ssr) warning: Duplicate key "storage_url" in object literal
33 |            file_size: 0
34 |          ,
35 |            storage_url: "file:///test/minimal.txt",
   |            ^
36 |            mime_type: "text/plain",
37 |            file_size: 0

  Plugin: vite:esbuild
  File: /Users/markmhendrickson/repos/neotoma/tests/integration/mcp_store_variations.test.ts
[2m6:03:34 PM[22m [33m[1m[vite][22m[39m (ssr) warning: Duplicate key "mime_type" in object literal
34 |          ,
35 |            storage_url: "file:///test/minimal.txt",
36 |            mime_type: "text/plain",
   |            ^
37 |            file_size: 0
38 |          })

  Plugin: vite:esbuild
  File: /Users/markmhendrickson/repos/neotoma/tests/integration/mcp_store_variations.test.ts
[2m6:03:34 PM[22m [33m[1m[vite][22m[39m (ssr) warning: Duplicate key "file_size" in object literal
35 |            storage_url: "file:///test/minimal.txt",
36 |            mime_type: "text/plain",
37 |            file_size: 0
   |            ^
38 |          })
39 |          .select()

  Plugin: vite:esbuild
  File: /Users/markmhendrickson/repos/neotoma/tests/integration/mcp_store_variations.test.ts
[2m6:03:34 PM[22m [33m[1m[vite][22m[39m (ssr) warning: Duplicate key "storage_url" in object literal
84 |            file_size: 0
85 |          ,
86 |            storage_url: "file:///test/minimal.txt",
   |            ^
87 |            mime_type: "text/plain",
88 |            file_size: 0

  Plugin: vite:esbuild
  File: /Users/markmhendrickson/repos/neotoma/tests/integration/mcp_store_variations.test.ts
[2m6:03:34 PM[22m [33m[1m[vite][22m[39m (ssr) warning: Duplicate key "mime_type" in object literal
85 |          ,
86 |            storage_url: "file:///test/minimal.txt",
87 |            mime_type: "text/plain",
   |            ^
88 |            file_size: 0
89 |          })

  Plugin: vite:esbuild
  File: /Users/markmhendrickson/repos/neotoma/tests/integration/mcp_store_variations.test.ts
[2m6:03:34 PM[22m [33m[1m[vite][22m[39m (ssr) warning: Duplicate key "file_size" in object literal
86 |            storage_url: "file:///test/minimal.txt",
87 |            mime_type: "text/plain",
88 |            file_size: 0
   |            ^
89 |          })
90 |          .select()

  Plugin: vite:esbuild
  File: /Users/markmhendrickson/repos/neotoma/tests/integration/mcp_store_variations.test.ts
[2m6:03:34 PM[22m [33m[1m[vite][22m[39m (ssr) warning: Duplicate key "storage_url" in object literal
132 |            file_size: 0
133 |          ,
134 |            storage_url: "file:///test/minimal.txt",
    |            ^
135 |            mime_type: "text/plain",
136 |            file_size: 0

  Plugin: vite:esbuild
  File: /Users/markmhendrickson/repos/neotoma/tests/integration/mcp_store_variations.test.ts
[2m6:03:34 PM[22m [33m[1m[vite][22m[39m (ssr) warning: Duplicate key "mime_type" in object literal
133 |          ,
134 |            storage_url: "file:///test/minimal.txt",
135 |            mime_type: "text/plain",
    |            ^
136 |            file_size: 0
137 |          })

  Plugin: vite:esbuild
  File: /Users/markmhendrickson/repos/neotoma/tests/integration/mcp_store_variations.test.ts
[2m6:03:34 PM[22m [33m[1m[vite][22m[39m (ssr) warning: Duplicate key "file_size" in object literal
134 |            storage_url: "file:///test/minimal.txt",
135 |            mime_type: "text/plain",
136 |            file_size: 0
    |            ^
137 |          })
138 |          .select()

  Plugin: vite:esbuild
  File: /Users/markmhendrickson/repos/neotoma/tests/integration/mcp_store_variations.test.ts
[2m6:03:34 PM[22m [33m[1m[vite][22m[39m (ssr) warning: Duplicate key "storage_url" in object literal
274 |            file_size: 0
275 |          ,
276 |            storage_url: "file:///test/minimal.txt",
    |            ^
277 |            mime_type: "text/plain",
278 |            file_size: 0

  Plugin: vite:esbuild
  File: /Users/markmhendrickson/repos/neotoma/tests/integration/mcp_store_variations.test.ts
[2m6:03:34 PM[22m [33m[1m[vite][22m[39m (ssr) warning: Duplicate key "mime_type" in object literal
275 |          ,
276 |            storage_url: "file:///test/minimal.txt",
277 |            mime_type: "text/plain",
    |            ^
278 |            file_size: 0
279 |          })

  Plugin: vite:esbuild
  File: /Users/markmhendrickson/repos/neotoma/tests/integration/mcp_store_variations.test.ts
[2m6:03:34 PM[22m [33m[1m[vite][22m[39m (ssr) warning: Duplicate key "file_size" in object literal
276 |            storage_url: "file:///test/minimal.txt",
277 |            mime_type: "text/plain",
278 |            file_size: 0
    |            ^
279 |          })
280 |          .select()

  Plugin: vite:esbuild
  File: /Users/markmhendrickson/repos/neotoma/tests/integration/mcp_store_variations.test.ts
 [31m‚ùØ[39m tests/integration/mcp_store_variations.test.ts [2m([22m[2m14 tests[22m[2m | [22m[31m7 failed[39m[2m)[22m[32m 54[2mms[22m[39m
[31m       [31m√ó[31m should store entities with minimal required fields[39m[32m 33[2mms[22m[39m
[31m       [31m√ó[31m should store entities with optional user_id as null[39m[32m 3[2mms[22m[39m
[31m       [31m√ó[31m should store entities with optional user_id as default UUID[39m[32m 1[2mms[22m[39m
[31m       [31m√ó[31m should store entities with custom source_priority[39m[32m 2[2mms[22m[39m
       [32m‚úì[39m should store entities with original_filename[32m 5[2mms[22m[39m
[31m       [31m√ó[31m should deduplicate sources with same content_hash[39m[32m 5[2mms[22m[39m
       [32m‚úì[39m should reject empty entities array[32m 1[2mms[22m[39m
[31m       [31m√ó[31m should store unstructured data with file_content (base64)[39m[32m 1[2mms[22m[39m
       [32m‚úì[39m should store unstructured data with file_path[32m 1[2mms[22m[39m
       [32m‚úì[39m should store unstructured data with interpret: false[32m 0[2mms[22m[39m
       [32m‚úì[39m should store unstructured data with custom interpretation_config[32m 1[2mms[22m[39m
       [32m‚úì[39m should accept same idempotency_key for identical operations[32m 0[2mms[22m[39m
       [32m‚úì[39m should reject invalid entity_type[32m 0[2mms[22m[39m
[31m       [31m√ó[31m should reject invalid source_id foreign key[39m[32m 0[2mms[22m[39m
 [31m‚ùØ[39m tests/integration/mcp_graph_variations.test.ts [2m([22m[2m19 tests[22m[2m | [22m[31m9 failed[39m[2m)[22m[32m 105[2mms[22m[39m
[31m       [31m√ó[31m should traverse 1-hop outbound[39m[32m 53[2mms[22m[39m
[31m       [31m√ó[31m should traverse 1-hop inbound[39m[32m 1[2mms[22m[39m
[31m       [31m√ó[31m should traverse 1-hop both directions[39m[32m 11[2mms[22m[39m
       [32m‚úì[39m should traverse 2-hop outbound[32m 1[2mms[22m[39m
       [32m‚úì[39m should filter by relationship_type: single type[32m 3[2mms[22m[39m
[31m       [31m√ó[31m should filter by relationship_types: multiple types[39m[32m 3[2mms[22m[39m
       [32m‚úì[39m should filter by relationship_types: empty (all types)[32m 3[2mms[22m[39m
[31m       [31m√ó[31m should return with include_entities: true[39m[32m 3[2mms[22m[39m
       [32m‚úì[39m should return with include_entities: false[32m 8[2mms[22m[39m
[31m       [31m√ó[31m should include relationships when include_relationships: true[39m[32m 3[2mms[22m[39m
       [32m‚úì[39m should exclude relationships when include_relationships: false[32m 3[2mms[22m[39m
[31m       [31m√ó[31m should include sources when include_sources: true[39m[32m 2[2mms[22m[39m
       [32m‚úì[39m should include events when include_events: true[32m 0[2mms[22m[39m
[31m       [31m√ó[31m should include observations when include_observations: true[39m[32m 1[2mms[22m[39m
       [32m‚úì[39m should work with node_type: entity[32m 0[2mms[22m[39m
[31m       [31m√ó[31m should work with node_type: source[39m[32m 1[2mms[22m[39m
       [32m‚úì[39m should handle max_hops: 1[32m 3[2mms[22m[39m
       [32m‚úì[39m should handle max_hops: 2[32m 3[2mms[22m[39m
       [32m‚úì[39m should handle max_hops: 3[32m 1[2mms[22m[39m
 [31m‚ùØ[39m tests/integration/mcp_schema_variations.test.ts [2m([22m[2m17 tests[22m[2m | [22m[31m2 failed[39m[2m)[22m[32m 108[2mms[22m[39m
       [32m‚úì[39m should list all entity types[32m 32[2mms[22m[39m
       [32m‚úì[39m should filter entity types by user_id[32m 6[2mms[22m[39m
       [32m‚úì[39m should register schema with minimal fields[32m 11[2mms[22m[39m
       [32m‚úì[39m should register schema with all field types[32m 1[2mms[22m[39m
       [32m‚úì[39m should register schema with different reducer strategies[32m 2[2mms[22m[39m
       [32m‚úì[39m should register user-specific schema[32m 0[2mms[22m[39m
       [32m‚úì[39m should register schema with activate: true[32m 0[2mms[22m[39m
[31m       [31m√ó[31m should register multiple schema versions[39m[32m 10[2mms[22m[39m
       [32m‚úì[39m should add new fields to existing schema[32m 1[2mms[22m[39m
       [32m‚úì[39m should update with migrate_existing: false[32m 2[2mms[22m[39m
[31m       [31m√ó[31m should analyze raw_fragments for schema candidates[39m[32m 1[2mms[22m[39m
       [32m‚úì[39m should filter by min_frequency threshold[32m 0[2mms[22m[39m
       [32m‚úì[39m should filter by min_confidence threshold[32m 0[2mms[22m[39m
       [32m‚úì[39m should get recommendations by source: raw_fragments[32m 2[2mms[22m[39m
       [32m‚úì[39m should get recommendations by status: pending[32m 41[2mms[22m[39m
       [32m‚úì[39m should check for stale snapshots without auto_fix[32m 1[2mms[22m[39m
       [32m‚úì[39m should check for stale snapshots with auto_fix: true[32m 0[2mms[22m[39m
 [31m‚ùØ[39m tests/integration/mcp_entity_variations.test.ts [2m([22m[2m13 tests[22m[2m | [22m[31m7 failed[39m[2m)[22m[32m 146[2mms[22m[39m
[31m       [31m√ó[31m should retrieve entity by entity_id[39m[32m 117[2mms[22m[39m
       [32m‚úì[39m should return null for non-existent entity_id[32m 0[2mms[22m[39m
[31m       [31m√ó[31m should paginate with limit and offset[39m[32m 5[2mms[22m[39m
       [32m‚úì[39m should filter by entity_type[32m 0[2mms[22m[39m
       [32m‚úì[39m should filter by user_id[32m 0[2mms[22m[39m
[31m       [31m√ó[31m should filter by user_id: null[39m[32m 3[2mms[22m[39m
[31m       [31m√ó[31m should search by canonical_name[39m[32m 0[2mms[22m[39m
[31m       [31m√ó[31m should find entity by canonical_name[39m[32m 6[2mms[22m[39m
       [32m‚úì[39m should return null for non-existent identifier[32m 0[2mms[22m[39m
[31m       [31m√ó[31m should merge two entities[39m[32m 5[2mms[22m[39m
       [32m‚úì[39m should delete entity with deletion observation[32m 1[2mms[22m[39m
[31m       [31m√ó[31m should restore deleted entity with restoration observation[39m[32m 1[2mms[22m[39m
       [32m‚úì[39m should return authenticated user from context[32m 0[2mms[22m[39m
 [31m‚ùØ[39m tests/integration/mcp_correction_variations.test.ts [2m([22m[2m13 tests[22m[2m | [22m[31m9 failed[39m[2m)[22m[32m 191[2mms[22m[39m
[31m       [31m√ó[31m should create correction observation for string field[39m[32m 110[2mms[22m[39m
[31m       [31m√ó[31m should create correction observation for number field[39m[32m 3[2mms[22m[39m
[31m       [31m√ó[31m should create correction observation for date field[39m[32m 1[2mms[22m[39m
[31m       [31m√ó[31m should create correction observation for boolean field[39m[32m 2[2mms[22m[39m
[31m       [31m√ó[31m should create correction observation for array field[39m[32m 36[2mms[22m[39m
[31m       [31m√ó[31m should create correction observation for object field[39m[32m 1[2mms[22m[39m
[31m       [31m√ó[31m should verify correction wins in snapshot computation[39m[32m 10[2mms[22m[39m
       [32m‚úì[39m should reinterpret source with default interpretation_config[32m 3[2mms[22m[39m
       [32m‚úì[39m should reinterpret source with custom model[32m 3[2mms[22m[39m
       [32m‚úì[39m should reinterpret source with custom temperature[32m 6[2mms[22m[39m
       [32m‚úì[39m should reinterpret source with custom max_tokens[32m 4[2mms[22m[39m
[31m       [31m√ó[31m should create new observations after reinterpretation[39m[32m 7[2mms[22m[39m
[31m       [31m√ó[31m should not modify existing observations during reinterpretation[39m[32m 4[2mms[22m[39m
 [31m‚ùØ[39m tests/integration/mcp_relationship_variations.test.ts [2m([22m[2m16 tests[22m[2m | [22m[31m13 failed[39m[2m)[22m[32m 229[2mms[22m[39m
[31m       [31m√ó[31m should create PART_OF relationship[39m[32m 123[2mms[22m[39m
[31m       [31m√ó[31m should create CORRECTS relationship[39m[32m 3[2mms[22m[39m
[31m       [31m√ó[31m should create REFERS_TO relationship[39m[32m 36[2mms[22m[39m
[31m       [31m√ó[31m should create SETTLES relationship[39m[32m 5[2mms[22m[39m
[31m       [31m√ó[31m should create DUPLICATE_OF relationship[39m[32m 2[2mms[22m[39m
[31m       [31m√ó[31m should create DEPENDS_ON relationship[39m[32m 3[2mms[22m[39m
[31m       [31m√ó[31m should create SUPERSEDES relationship[39m[32m 1[2mms[22m[39m
[31m       [31m√ó[31m should create EMBEDS relationship[39m[32m 1[2mms[22m[39m
[31m       [31m√ó[31m should create relationship with optional metadata[39m[32m 19[2mms[22m[39m
[31m       [31m√ó[31m should list relationships with direction: outbound[39m[32m 10[2mms[22m[39m
[31m       [31m√ó[31m should list relationships with direction: inbound[39m[32m 3[2mms[22m[39m
[31m       [31m√ó[31m should list relationships with direction: both[39m[32m 10[2mms[22m[39m
       [32m‚úì[39m should filter relationships by relationship_type[32m 3[2mms[22m[39m
[31m       [31m√ó[31m should retrieve relationship snapshot[39m[32m 4[2mms[22m[39m
       [32m‚úì[39m should delete relationship with deletion observation[32m 4[2mms[22m[39m
       [32m‚úì[39m should restore deleted relationship with restoration observation[32m 1[2mms[22m[39m
 [31m‚ùØ[39m tests/integration/mcp_resource_variations.test.ts [2m([22m[2m27 tests[22m[2m | [22m[31m6 failed[39m[2m)[22m[32m 229[2mms[22m[39m
       [32m‚úì[39m should generate signed URL for file with default expiry[32m 1[2mms[22m[39m
       [32m‚úì[39m should generate signed URL with custom expiry[32m 0[2mms[22m[39m
       [32m‚úì[39m should handle file paths with special characters[32m 0[2mms[22m[39m
[31m       [31m√ó[31m should list observations for entity_id[39m[32m 160[2mms[22m[39m
[31m       [31m√ó[31m should paginate observations with limit[39m[32m 48[2mms[22m[39m
[31m       [31m√ó[31m should paginate observations with offset[39m[32m 13[2mms[22m[39m
[31m       [31m√ó[31m should retrieve provenance chain for specific field[39m[32m 2[2mms[22m[39m
[31m       [31m√ó[31m should trace field through multiple observations[39m[32m 2[2mms[22m[39m
       [32m‚úì[39m should list timeline events with pagination[32m 0[2mms[22m[39m
       [32m‚úì[39m should filter timeline events by event_type[32m 0[2mms[22m[39m
[31m       [31m√ó[31m should filter timeline events by date range[39m[32m 1[2mms[22m[39m
       [32m‚úì[39m should filter timeline events by user_id[32m 1[2mms[22m[39m
       [32m‚úì[39m should handle neotoma://entity_snapshots pattern[32m 0[2mms[22m[39m
       [32m‚úì[39m should handle neotoma://entity_snapshots/{id} pattern[32m 0[2mms[22m[39m
       [32m‚úì[39m should handle neotoma://observations pattern[32m 0[2mms[22m[39m
       [32m‚úì[39m should handle neotoma://observations/{id} pattern[32m 0[2mms[22m[39m
       [32m‚úì[39m should handle neotoma://source pattern[32m 0[2mms[22m[39m
       [32m‚úì[39m should handle neotoma://source/{id} pattern[32m 0[2mms[22m[39m
       [32m‚úì[39m should handle neotoma://relationship_snapshots pattern[32m 0[2mms[22m[39m
       [32m‚úì[39m should handle neotoma://relationship_snapshots/{id} pattern[32m 0[2mms[22m[39m
       [32m‚úì[39m should handle neotoma://timeline_events pattern[32m 0[2mms[22m[39m
       [32m‚úì[39m should handle neotoma://timeline_events/{id} pattern[32m 0[2mms[22m[39m
       [32m‚úì[39m should handle neotoma://schema_registry pattern[32m 0[2mms[22m[39m
       [32m‚úì[39m should handle neotoma://schema_registry/{entity_type} pattern[32m 0[2mms[22m[39m
       [32m‚úì[39m should handle neotoma://entity_types pattern[32m 0[2mms[22m[39m
       [32m‚úì[39m should handle invalid entity_id in list_observations[32m 0[2mms[22m[39m
       [32m‚úì[39m should handle invalid source_id[32m 0[2mms[22m[39m
 [31m‚ùØ[39m tests/integration/mcp_query_variations.test.ts [2m([22m[2m20 tests[22m[2m | [22m[31m11 failed[39m[2m)[22m[32m 36[2mms[22m[39m
[31m       [31m√ó[31m should paginate with default limit[39m[32m 10[2mms[22m[39m
[31m       [31m√ó[31m should paginate with custom limit[39m[32m 1[2mms[22m[39m
[31m       [31m√ó[31m should paginate with offset[39m[32m 1[2mms[22m[39m
[31m       [31m√ó[31m should paginate with min limit (1)[39m[32m 1[2mms[22m[39m
       [32m‚úì[39m should paginate with max limit boundary[32m 0[2mms[22m[39m
       [32m‚úì[39m should handle offset beyond data[32m 0[2mms[22m[39m
       [32m‚úì[39m should paginate deterministically (same order on multiple calls)[32m 1[2mms[22m[39m
       [32m‚úì[39m should filter by entity_type[32m 0[2mms[22m[39m
       [32m‚úì[39m should filter by user_id[32m 1[2mms[22m[39m
[31m       [31m√ó[31m should filter by user_id: null[39m[32m 2[2mms[22m[39m
[31m       [31m√ó[31m should search by canonical_name with ILIKE[39m[32m 3[2mms[22m[39m
[31m       [31m√ó[31m should combine multiple filters[39m[32m 0[2mms[22m[39m
       [32m‚úì[39m should sort by entity_id ascending[32m 0[2mms[22m[39m
       [32m‚úì[39m should sort by entity_id descending[32m 0[2mms[22m[39m
[31m       [31m√ó[31m should sort by canonical_name[39m[32m 1[2mms[22m[39m
[31m       [31m√ó[31m should sort by multiple columns[39m[32m 0[2mms[22m[39m
       [32m‚úì[39m should maintain deterministic order[32m 0[2mms[22m[39m
[31m       [31m√ó[31m should combine all query operations[39m[32m 0[2mms[22m[39m
[31m       [31m√ó[31m should exclude merged entities by default[39m[32m 0[2mms[22m[39m
       [32m‚úì[39m should include merged entities when requested[32m 0[2mms[22m[39m
 [32m‚úì[39m tests/integration/public_key_registry.test.ts [2m([22m[2m16 tests[22m[2m)[22m[33m 426[2mms[22m[39m
 [32m‚úì[39m tests/integration/dashboard_stats.test.ts [2m([22m[2m12 tests[22m[2m)[22m[32m 16[2mms[22m[39m
 [2m[90m‚Üì[39m[22m tests/integration/mcp_oauth_flow.test.ts [2m([22m[2m22 tests[22m[2m | [22m[33m22 skipped[39m[2m)[22m
[90mstderr[2m | tests/integration/v0.2.0_ingestion.test.ts[2m > [22m[2mv0.2.0 Integration Tests[2m > [22m[2mIT-001: Raw File Ingestion Flow[2m > [22m[2mshould link observations to source and interpretation run
[22m[39m[entity_resolution] Final canonical name: test note for entityType: note

[90mstderr[2m | tests/integration/v0.2.0_ingestion.test.ts[2m > [22m[2mv0.2.0 Integration Tests[2m > [22m[2mIT-003: Reinterpretation Immutability[2m > [22m[2mshould create new observations without modifying existing ones
[22m[39m[entity_resolution] Final canonical name: original note for entityType: note

[90mstderr[2m | tests/integration/v0.2.0_ingestion.test.ts[2m > [22m[2mv0.2.0 Integration Tests[2m > [22m[2mIT-003: Reinterpretation Immutability[2m > [22m[2mshould create new observations without modifying existing ones
[22m[39m[entity_resolution] Final canonical name: original note for entityType: note

[90mstderr[2m | tests/integration/v0.2.0_ingestion.test.ts[2m > [22m[2mv0.2.0 Integration Tests[2m > [22m[2mIT-009: Provenance Chain[2m > [22m[2mshould maintain complete provenance chain
[22m[39m[entity_resolution] Final canonical name: provenance note for entityType: note

 [32m‚úì[39m tests/integration/v0.2.0_ingestion.test.ts [2m([22m[2m11 tests[22m[2m)[22m[32m 73[2mms[22m[39m

[31m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[39m[1m[41m Failed Tests 64 [49m[22m[31m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[39m

[41m[1m FAIL [22m[49m tests/integration/mcp_correction_variations.test.ts[2m > [22mMCP correction and reinterpretation - parameter variations[2m > [22mcorrect action variations[2m > [22mshould create correction observation for string field
[31m[1mTypeError[22m: Cannot read properties of null (reading 'observed_properties')[39m
[36m [2m‚ùØ[22m tests/integration/mcp_correction_variations.test.ts:[2m62:26[22m[39m
    [90m 60| [39m
    [90m 61| [39m      [34mexpect[39m(correction)[33m.[39m[34mtoBeDefined[39m()[33m;[39m
    [90m 62| [39m      expect(correction!.observed_properties.title).toBe("Corrected Ti‚Ä¶
    [90m   | [39m                         [31m^[39m
    [90m 63| [39m      [34mexpect[39m(correction[33m![39m[33m.[39mpriority)[33m.[39m[34mtoBe[39m([34m1000[39m)[33m;[39m
    [90m 64| [39m    })[33m;[39m

[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[1/64]‚éØ[22m[39m

[41m[1m FAIL [22m[49m tests/integration/mcp_correction_variations.test.ts[2m > [22mMCP correction and reinterpretation - parameter variations[2m > [22mcorrect action variations[2m > [22mshould create correction observation for number field
[31m[1mTypeError[22m: Cannot read properties of null (reading 'observed_properties')[39m
[36m [2m‚ùØ[22m tests/integration/mcp_correction_variations.test.ts:[2m112:26[22m[39m
    [90m110| [39m        [33m.[39m[34msingle[39m()[33m;[39m
    [90m111| [39m
    [90m112| [39m      [34mexpect[39m(correction[33m![39m[33m.[39mobserved_properties[33m.[39mpriority)[33m.[39m[34mtoBe[39m([34m5[39m)[33m;[39m
    [90m   | [39m                         [31m^[39m
    [90m113| [39m    })[33m;[39m
    [90m114| [39m

[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[2/64]‚éØ[22m[39m

[41m[1m FAIL [22m[49m tests/integration/mcp_correction_variations.test.ts[2m > [22mMCP correction and reinterpretation - parameter variations[2m > [22mcorrect action variations[2m > [22mshould create correction observation for date field
[31m[1mTypeError[22m: Cannot read properties of null (reading 'observed_properties')[39m
[36m [2m‚ùØ[22m tests/integration/mcp_correction_variations.test.ts:[2m161:26[22m[39m
    [90m159| [39m        [33m.[39m[34msingle[39m()[33m;[39m
    [90m160| [39m
    [90m161| [39m      expect(correction!.observed_properties.due_date).toBe("2025-12-3‚Ä¶
    [90m   | [39m                         [31m^[39m
    [90m162| [39m    })[33m;[39m
    [90m163| [39m

[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[3/64]‚éØ[22m[39m

[41m[1m FAIL [22m[49m tests/integration/mcp_correction_variations.test.ts[2m > [22mMCP correction and reinterpretation - parameter variations[2m > [22mcorrect action variations[2m > [22mshould create correction observation for boolean field
[31m[1mTypeError[22m: Cannot read properties of null (reading 'observed_properties')[39m
[36m [2m‚ùØ[22m tests/integration/mcp_correction_variations.test.ts:[2m210:26[22m[39m
    [90m208| [39m        [33m.[39m[34msingle[39m()[33m;[39m
    [90m209| [39m
    [90m210| [39m      [34mexpect[39m(correction[33m![39m[33m.[39mobserved_properties[33m.[39mcompleted)[33m.[39m[34mtoBe[39m([35mtrue[39m)[33m;[39m
    [90m   | [39m                         [31m^[39m
    [90m211| [39m    })[33m;[39m
    [90m212| [39m

[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[4/64]‚éØ[22m[39m

[41m[1m FAIL [22m[49m tests/integration/mcp_correction_variations.test.ts[2m > [22mMCP correction and reinterpretation - parameter variations[2m > [22mcorrect action variations[2m > [22mshould create correction observation for array field
[31m[1mTypeError[22m: Cannot read properties of null (reading 'observed_properties')[39m
[36m [2m‚ùØ[22m tests/integration/mcp_correction_variations.test.ts:[2m259:26[22m[39m
    [90m257| [39m        [33m.[39m[34msingle[39m()[33m;[39m
    [90m258| [39m
    [90m259| [39m      expect(correction!.observed_properties.tags).toEqual(["new-tag-1‚Ä¶
    [90m   | [39m                         [31m^[39m
    [90m260| [39m    })[33m;[39m
    [90m261| [39m

[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[5/64]‚éØ[22m[39m

[41m[1m FAIL [22m[49m tests/integration/mcp_correction_variations.test.ts[2m > [22mMCP correction and reinterpretation - parameter variations[2m > [22mcorrect action variations[2m > [22mshould create correction observation for object field
[31m[1mTypeError[22m: Cannot read properties of null (reading 'observed_properties')[39m
[36m [2m‚ùØ[22m tests/integration/mcp_correction_variations.test.ts:[2m308:26[22m[39m
    [90m306| [39m        [33m.[39m[34msingle[39m()[33m;[39m
    [90m307| [39m
    [90m308| [39m      [34mexpect[39m(correction[33m![39m[33m.[39mobserved_properties[33m.[39mmetadata)[33m.[39m[34mtoEqual[39m({
    [90m   | [39m                         [31m^[39m
    [90m309| [39m        key[33m:[39m [32m"new value"[39m[33m,[39m
    [90m310| [39m        extra[33m:[39m [32m"data"[39m

[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[6/64]‚éØ[22m[39m

[41m[1m FAIL [22m[49m tests/integration/mcp_correction_variations.test.ts[2m > [22mMCP correction and reinterpretation - parameter variations[2m > [22mcorrect action variations[2m > [22mshould verify correction wins in snapshot computation
[31m[1mAssertionError[22m: expected { ‚Ä¶(2) } to be null[39m

[32m- Expected:[39m 
null

[31m+ Received:[39m 
{
  "code": "PGRST116",
  "message": "SELECT on table 'entities' returned no rows (expected exactly one). Query had: WHERE id = ?.",
}

[36m [2m‚ùØ[22m verifyEntityExists tests/helpers/database_verifiers.ts:[2m97:17[22m[39m
    [90m 95| [39m    [33m.[39m[34msingle[39m()[33m;[39m
    [90m 96| [39m
    [90m 97| [39m  [34mexpect[39m(error)[33m.[39m[34mtoBeNull[39m()[33m;[39m
    [90m   | [39m                [31m^[39m
    [90m 98| [39m  [34mexpect[39m(entity)[33m.[39m[34mtoBeDefined[39m()[33m;[39m
    [90m 99| [39m  [34mexpect[39m(entity[33m.[39mentity_type)[33m.[39m[34mtoBe[39m(expected[33m.[39mentity_type)[33m;[39m
[90m [2m‚ùØ[22m tests/integration/mcp_correction_variations.test.ts:[2m358:7[22m[39m

[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[7/64]‚éØ[22m[39m

[41m[1m FAIL [22m[49m tests/integration/mcp_correction_variations.test.ts[2m > [22mMCP correction and reinterpretation - parameter variations[2m > [22mreinterpret action variations[2m > [22mshould create new observations after reinterpretation
[31m[1mAssertionError[22m: expected 0 to be greater than 0[39m
[36m [2m‚ùØ[22m tests/integration/mcp_correction_variations.test.ts:[2m505:36[22m[39m
    [90m503| [39m        [33m.[39m[34meq[39m([32m"source_id"[39m[33m,[39m source[33m![39m[33m.[39mid)[33m;[39m
    [90m504| [39m
    [90m505| [39m      [34mexpect[39m(observations[33m![39m[33m.[39mlength)[33m.[39m[34mtoBeGreaterThan[39m([34m0[39m)[33m;[39m
    [90m   | [39m                                   [31m^[39m
    [90m506| [39m    })[33m;[39m
    [90m507| [39m

[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[8/64]‚éØ[22m[39m

[41m[1m FAIL [22m[49m tests/integration/mcp_correction_variations.test.ts[2m > [22mMCP correction and reinterpretation - parameter variations[2m > [22mreinterpret action variations[2m > [22mshould not modify existing observations during reinterpretation
[31m[1mTypeError[22m: Cannot read properties of null (reading 'observation_id')[39m
[36m [2m‚ùØ[22m tests/integration/mcp_correction_variations.test.ts:[2m547:44[22m[39m
    [90m545| [39m        [33m.[39m[35mfrom[39m([32m"observations"[39m)
    [90m546| [39m        [33m.[39m[34mselect[39m([32m"*"[39m)
    [90m547| [39m        [33m.[39m[34meq[39m([32m"observation_id"[39m[33m,[39m originalObs[33m![39m[33m.[39mobservation_id)
    [90m   | [39m                                           [31m^[39m
    [90m548| [39m        [33m.[39m[34msingle[39m()[33m;[39m
    [90m549| [39m

[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[9/64]‚éØ[22m[39m

[41m[1m FAIL [22m[49m tests/integration/mcp_entity_variations.test.ts[2m > [22mMCP entity actions - parameter variations[2m > [22mretrieve_entity_snapshot variations[2m > [22mshould retrieve entity by entity_id
[31m[1mTypeError[22m: Cannot read properties of null (reading 'entity_id')[39m
[36m [2m‚ùØ[22m tests/integration/mcp_entity_variations.test.ts:[2m54:22[22m[39m
    [90m 52| [39m
    [90m 53| [39m      [34mexpect[39m(entity)[33m.[39m[34mtoBeDefined[39m()[33m;[39m
    [90m 54| [39m      [34mexpect[39m(entity[33m![39m[33m.[39mentity_id)[33m.[39m[34mtoBe[39m(entityId)[33m;[39m
    [90m   | [39m                     [31m^[39m
    [90m 55| [39m      [34mexpect[39m(entity[33m![39m[33m.[39mentity_type)[33m.[39m[34mtoBe[39m([32m"task"[39m)[33m;[39m
    [90m 56| [39m    })[33m;[39m

[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[10/64]‚éØ[22m[39m

[41m[1m FAIL [22m[49m tests/integration/mcp_entity_variations.test.ts[2m > [22mMCP entity actions - parameter variations[2m > [22mretrieve_entities variations[2m > [22mshould paginate with limit and offset
[31m[1mAssertionError[22m: expected [] to have a length of 5 but got +0[39m

[32m- Expected[39m
[31m+ Received[39m

[32m- 5[39m
[31m+ 0[39m

[36m [2m‚ùØ[22m tests/integration/mcp_entity_variations.test.ts:[2m109:21[22m[39m
    [90m107| [39m        [33m.[39m[34mrange[39m([34m0[39m[33m,[39m [34m4[39m)[33m;[39m
    [90m108| [39m
    [90m109| [39m      [34mexpect[39m(page1)[33m.[39m[34mtoHaveLength[39m([34m5[39m)[33m;[39m
    [90m   | [39m                    [31m^[39m
    [90m110| [39m
    [90m111| [39m      [35mconst[39m { data[33m:[39m page2 } [33m=[39m [35mawait[39m supabase

[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[11/64]‚éØ[22m[39m

[41m[1m FAIL [22m[49m tests/integration/mcp_entity_variations.test.ts[2m > [22mMCP entity actions - parameter variations[2m > [22mretrieve_entities variations[2m > [22mshould filter by user_id: null
[31m[1mAssertionError[22m: expected false to be true // Object.is equality[39m

[32m- Expected[39m
[31m+ Received[39m

[32m- true[39m
[31m+ false[39m

[36m [2m‚ùØ[22m tests/integration/mcp_entity_variations.test.ts:[2m180:63[22m[39m
    [90m178| [39m        [33m.[39m[34mis[39m([32m"user_id"[39m[33m,[39m [35mnull[39m)[33m;[39m
    [90m179| [39m
    [90m180| [39m      expect(entities!.some((e) => e.entity_id === entityId)).toBe(tru‚Ä¶
    [90m   | [39m                                                              [31m^[39m
    [90m181| [39m    })[33m;[39m
    [90m182| [39m

[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[12/64]‚éØ[22m[39m

[41m[1m FAIL [22m[49m tests/integration/mcp_entity_variations.test.ts[2m > [22mMCP entity actions - parameter variations[2m > [22mretrieve_entities variations[2m > [22mshould search by canonical_name
[31m[1mTypeError[22m: __vite_ssr_import_1__.supabase.from(...).select(...).eq(...).ilike is not a function[39m
[36m [2m‚ùØ[22m tests/integration/mcp_entity_variations.test.ts:[2m188:10[22m[39m
    [90m186| [39m        [33m.[39m[34mselect[39m([32m"*"[39m)
    [90m187| [39m        [33m.[39m[34meq[39m([32m"user_id"[39m[33m,[39m testUserId)
    [90m188| [39m        [33m.[39m[34milike[39m([32m"canonical_name"[39m[33m,[39m [32m"%Task%"[39m)[33m;[39m
    [90m   | [39m         [31m^[39m
    [90m189| [39m
    [90m190| [39m      [34mexpect[39m(entities[33m![39m[33m.[39mlength)[33m.[39m[34mtoBeGreaterThan[39m([34m0[39m)[33m;[39m

[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[13/64]‚éØ[22m[39m

[41m[1m FAIL [22m[49m tests/integration/mcp_entity_variations.test.ts[2m > [22mMCP entity actions - parameter variations[2m > [22mretrieve_entity_by_identifier variations[2m > [22mshould find entity by canonical_name
[31m[1mTypeError[22m: Cannot read properties of null (reading 'canonical_name')[39m
[36m [2m‚ùØ[22m tests/integration/mcp_entity_variations.test.ts:[2m230:22[22m[39m
    [90m228| [39m
    [90m229| [39m      [34mexpect[39m(entity)[33m.[39m[34mtoBeDefined[39m()[33m;[39m
    [90m230| [39m      [34mexpect[39m(entity[33m![39m[33m.[39mcanonical_name)[33m.[39m[34mtoBe[39m(canonicalName)[33m;[39m
    [90m   | [39m                     [31m^[39m
    [90m231| [39m    })[33m;[39m
    [90m232| [39m

[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[14/64]‚éØ[22m[39m

[41m[1m FAIL [22m[49m tests/integration/mcp_entity_variations.test.ts[2m > [22mMCP entity actions - parameter variations[2m > [22mmerge_entities variations[2m > [22mshould merge two entities
[31m[1mAssertionError[22m: expected { ‚Ä¶(2) } to be null[39m

[32m- Expected:[39m 
null

[31m+ Received:[39m 
{
  "code": "PGRST116",
  "message": "SELECT on table 'entities' returned no rows (expected exactly one). Query had: WHERE id = ?.",
}

[36m [2m‚ùØ[22m verifyEntityExists tests/helpers/database_verifiers.ts:[2m97:17[22m[39m
    [90m 95| [39m    [33m.[39m[34msingle[39m()[33m;[39m
    [90m 96| [39m
    [90m 97| [39m  [34mexpect[39m(error)[33m.[39m[34mtoBeNull[39m()[33m;[39m
    [90m   | [39m                [31m^[39m
    [90m 98| [39m  [34mexpect[39m(entity)[33m.[39m[34mtoBeDefined[39m()[33m;[39m
    [90m 99| [39m  [34mexpect[39m(entity[33m.[39mentity_type)[33m.[39m[34mtoBe[39m(expected[33m.[39mentity_type)[33m;[39m
[90m [2m‚ùØ[22m tests/integration/mcp_entity_variations.test.ts:[2m286:7[22m[39m

[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[15/64]‚éØ[22m[39m

[41m[1m FAIL [22m[49m tests/integration/mcp_entity_variations.test.ts[2m > [22mMCP entity actions - parameter variations[2m > [22mrestore_entity variations[2m > [22mshould restore deleted entity with restoration observation
[31m[1mAssertionError[22m: expected { ‚Ä¶(2) } to be null[39m

[32m- Expected:[39m 
null

[31m+ Received:[39m 
{
  "code": "PGRST116",
  "message": "SELECT on table 'entities' returned no rows (expected exactly one). Query had: WHERE id = ?.",
}

[36m [2m‚ùØ[22m verifyEntityExists tests/helpers/database_verifiers.ts:[2m97:17[22m[39m
    [90m 95| [39m    [33m.[39m[34msingle[39m()[33m;[39m
    [90m 96| [39m
    [90m 97| [39m  [34mexpect[39m(error)[33m.[39m[34mtoBeNull[39m()[33m;[39m
    [90m   | [39m                [31m^[39m
    [90m 98| [39m  [34mexpect[39m(entity)[33m.[39m[34mtoBeDefined[39m()[33m;[39m
    [90m 99| [39m  [34mexpect[39m(entity[33m.[39mentity_type)[33m.[39m[34mtoBe[39m(expected[33m.[39mentity_type)[33m;[39m
[90m [2m‚ùØ[22m tests/integration/mcp_entity_variations.test.ts:[2m391:7[22m[39m

[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[16/64]‚éØ[22m[39m

[41m[1m FAIL [22m[49m tests/integration/mcp_graph_variations.test.ts[2m > [22mMCP graph actions - parameter variations[2m > [22mretrieve_related_entities variations[2m > [22mshould traverse 1-hop outbound
[31m[1mAssertionError[22m: expected 0 to be greater than 0[39m
[36m [2m‚ùØ[22m tests/integration/mcp_graph_variations.test.ts:[2m92:37[22m[39m
    [90m 90| [39m        [33m.[39m[34meq[39m([32m"source_entity_id"[39m[33m,[39m entityA)[33m;[39m
    [90m 91| [39m
    [90m 92| [39m      [34mexpect[39m(relationships[33m![39m[33m.[39mlength)[33m.[39m[34mtoBeGreaterThan[39m([34m0[39m)[33m;[39m
    [90m   | [39m                                    [31m^[39m
    [90m 93| [39m      [34mexpect[39m(relationships[33m![39m[[34m0[39m][33m.[39mtarget_entity_id)[33m.[39m[34mtoBe[39m(entityB)[33m;[39m
    [90m 94| [39m    })[33m;[39m

[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[17/64]‚éØ[22m[39m

[41m[1m FAIL [22m[49m tests/integration/mcp_graph_variations.test.ts[2m > [22mMCP graph actions - parameter variations[2m > [22mretrieve_related_entities variations[2m > [22mshould traverse 1-hop inbound
[31m[1mAssertionError[22m: expected 0 to be greater than 0[39m
[36m [2m‚ùØ[22m tests/integration/mcp_graph_variations.test.ts:[2m104:37[22m[39m
    [90m102| [39m        [33m.[39m[34meq[39m([32m"target_entity_id"[39m[33m,[39m entityB)[33m;[39m
    [90m103| [39m
    [90m104| [39m      [34mexpect[39m(relationships[33m![39m[33m.[39mlength)[33m.[39m[34mtoBeGreaterThan[39m([34m0[39m)[33m;[39m
    [90m   | [39m                                    [31m^[39m
    [90m105| [39m      [34mexpect[39m(relationships[33m![39m[[34m0[39m][33m.[39msource_entity_id)[33m.[39m[34mtoBe[39m(entityA)[33m;[39m
    [90m106| [39m    })[33m;[39m

[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[18/64]‚éØ[22m[39m

[41m[1m FAIL [22m[49m tests/integration/mcp_graph_variations.test.ts[2m > [22mMCP graph actions - parameter variations[2m > [22mretrieve_related_entities variations[2m > [22mshould traverse 1-hop both directions
[31m[1mAssertionError[22m: expected 0 to be greater than 0[39m
[36m [2m‚ùØ[22m tests/integration/mcp_graph_variations.test.ts:[2m121:32[22m[39m
    [90m119| [39m        [33m.[39m[34meq[39m([32m"target_entity_id"[39m[33m,[39m entityB)[33m;[39m
    [90m120| [39m
    [90m121| [39m      [34mexpect[39m(outbound[33m![39m[33m.[39mlength)[33m.[39m[34mtoBeGreaterThan[39m([34m0[39m)[33m;[39m
    [90m   | [39m                               [31m^[39m
    [90m122| [39m      [34mexpect[39m(inbound[33m![39m[33m.[39mlength)[33m.[39m[34mtoBeGreaterThan[39m([34m0[39m)[33m;[39m
    [90m123| [39m    })[33m;[39m

[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[19/64]‚éØ[22m[39m

[41m[1m FAIL [22m[49m tests/integration/mcp_graph_variations.test.ts[2m > [22mMCP graph actions - parameter variations[2m > [22mretrieve_related_entities variations[2m > [22mshould filter by relationship_types: multiple types
[31m[1mAssertionError[22m: expected 0 to be greater than 0[39m
[36m [2m‚ùØ[22m tests/integration/mcp_graph_variations.test.ts:[2m177:37[22m[39m
    [90m175| [39m        [33m.[39m[35min[39m([32m"relationship_type"[39m[33m,[39m [[32m"REFERS_TO"[39m[33m,[39m [32m"PART_OF"[39m])[33m;[39m
    [90m176| [39m
    [90m177| [39m      [34mexpect[39m(relationships[33m![39m[33m.[39mlength)[33m.[39m[34mtoBeGreaterThan[39m([34m0[39m)[33m;[39m
    [90m   | [39m                                    [31m^[39m
    [90m178| [39m    })[33m;[39m
    [90m179| [39m

[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[20/64]‚éØ[22m[39m

[41m[1m FAIL [22m[49m tests/integration/mcp_graph_variations.test.ts[2m > [22mMCP graph actions - parameter variations[2m > [22mretrieve_related_entities variations[2m > [22mshould return with include_entities: true
[31m[1mAssertionError[22m: expected 0 to be greater than 0[39m
[36m [2m‚ùØ[22m tests/integration/mcp_graph_variations.test.ts:[2m207:32[22m[39m
    [90m205| [39m
    [90m206| [39m      [34mexpect[39m(entities)[33m.[39m[34mtoBeDefined[39m()[33m;[39m
    [90m207| [39m      [34mexpect[39m(entities[33m![39m[33m.[39mlength)[33m.[39m[34mtoBeGreaterThan[39m([34m0[39m)[33m;[39m
    [90m   | [39m                               [31m^[39m
    [90m208| [39m    })[33m;[39m
    [90m209| [39m

[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[21/64]‚éØ[22m[39m

[41m[1m FAIL [22m[49m tests/integration/mcp_graph_variations.test.ts[2m > [22mMCP graph actions - parameter variations[2m > [22mretrieve_graph_neighborhood variations[2m > [22mshould include relationships when include_relationships: true
[31m[1mAssertionError[22m: expected 0 to be greater than 0[39m
[36m [2m‚ùØ[22m tests/integration/mcp_graph_variations.test.ts:[2m232:37[22m[39m
    [90m230| [39m        .or(`source_entity_id.eq.${entityB},target_entity_id.eq.${enti‚Ä¶
    [90m231| [39m
    [90m232| [39m      [34mexpect[39m(relationships[33m![39m[33m.[39mlength)[33m.[39m[34mtoBeGreaterThan[39m([34m0[39m)[33m;[39m
    [90m   | [39m                                    [31m^[39m
    [90m233| [39m    })[33m;[39m
    [90m234| [39m

[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[22/64]‚éØ[22m[39m

[41m[1m FAIL [22m[49m tests/integration/mcp_graph_variations.test.ts[2m > [22mMCP graph actions - parameter variations[2m > [22mretrieve_graph_neighborhood variations[2m > [22mshould include sources when include_sources: true
[31m[1mAssertionError[22m: expected false to be true // Object.is equality[39m

[32m- Expected[39m
[31m+ Received[39m

[32m- true[39m
[31m+ false[39m

[36m [2m‚ùØ[22m tests/integration/mcp_graph_variations.test.ts:[2m257:68[22m[39m
    [90m255| [39m        [33m.[39m[34meq[39m([32m"entity_id"[39m[33m,[39m entityB)[33m;[39m
    [90m256| [39m
    [90m257| [39m      expect(observations!.some((o) => o.source_id === source.id)).toB‚Ä¶
    [90m   | [39m                                                                   [31m^[39m
    [90m258| [39m    })[33m;[39m
    [90m259| [39m

[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[23/64]‚éØ[22m[39m

[41m[1m FAIL [22m[49m tests/integration/mcp_graph_variations.test.ts[2m > [22mMCP graph actions - parameter variations[2m > [22mretrieve_graph_neighborhood variations[2m > [22mshould include observations when include_observations: true
[31m[1mAssertionError[22m: expected 0 to be greater than 0[39m
[36m [2m‚ùØ[22m tests/integration/mcp_graph_variations.test.ts:[2m281:36[22m[39m
    [90m279| [39m        [33m.[39m[34meq[39m([32m"entity_id"[39m[33m,[39m entityB)[33m;[39m
    [90m280| [39m
    [90m281| [39m      [34mexpect[39m(observations[33m![39m[33m.[39mlength)[33m.[39m[34mtoBeGreaterThan[39m([34m0[39m)[33m;[39m
    [90m   | [39m                                   [31m^[39m
    [90m282| [39m    })[33m;[39m
    [90m283| [39m

[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[24/64]‚éØ[22m[39m

[41m[1m FAIL [22m[49m tests/integration/mcp_graph_variations.test.ts[2m > [22mMCP graph actions - parameter variations[2m > [22mretrieve_graph_neighborhood variations[2m > [22mshould work with node_type: source
[31m[1mAssertionError[22m: expected 0 to be greater than 0[39m
[36m [2m‚ùØ[22m tests/integration/mcp_graph_variations.test.ts:[2m313:36[22m[39m
    [90m311| [39m        [33m.[39m[34meq[39m([32m"source_id"[39m[33m,[39m source[33m.[39mid)[33m;[39m
    [90m312| [39m
    [90m313| [39m      [34mexpect[39m(observations[33m![39m[33m.[39mlength)[33m.[39m[34mtoBeGreaterThan[39m([34m0[39m)[33m;[39m
    [90m   | [39m                                   [31m^[39m
    [90m314| [39m    })[33m;[39m
    [90m315| [39m  })[33m;[39m

[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[25/64]‚éØ[22m[39m

[41m[1m FAIL [22m[49m tests/integration/mcp_query_variations.test.ts[2m > [22mMCP query actions - parameter variations[2m > [22mpagination variations[2m > [22mshould paginate with default limit
[31m[1mAssertionError[22m: expected [] to have a length of 10 but got +0[39m

[32m- Expected[39m
[31m+ Received[39m

[32m- 10[39m
[31m+ 0[39m

[36m [2m‚ùØ[22m tests/integration/mcp_query_variations.test.ts:[2m57:24[22m[39m
    [90m 55| [39m        [33m.[39m[34mlimit[39m([34m10[39m)[33m;[39m
    [90m 56| [39m
    [90m 57| [39m      [34mexpect[39m(entities)[33m.[39m[34mtoHaveLength[39m([34m10[39m)[33m;[39m
    [90m   | [39m                       [31m^[39m
    [90m 58| [39m    })[33m;[39m
    [90m 59| [39m

[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[26/64]‚éØ[22m[39m

[41m[1m FAIL [22m[49m tests/integration/mcp_query_variations.test.ts[2m > [22mMCP query actions - parameter variations[2m > [22mpagination variations[2m > [22mshould paginate with custom limit
[31m[1mAssertionError[22m: expected [] to have a length of 5 but got +0[39m

[32m- Expected[39m
[31m+ Received[39m

[32m- 5[39m
[31m+ 0[39m

[36m [2m‚ùØ[22m tests/integration/mcp_query_variations.test.ts:[2m70:24[22m[39m
    [90m 68| [39m        [33m.[39m[34mlimit[39m(customLimit)[33m;[39m
    [90m 69| [39m
    [90m 70| [39m      [34mexpect[39m(entities)[33m.[39m[34mtoHaveLength[39m(customLimit)[33m;[39m
    [90m   | [39m                       [31m^[39m
    [90m 71| [39m    })[33m;[39m
    [90m 72| [39m

[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[27/64]‚éØ[22m[39m

[41m[1m FAIL [22m[49m tests/integration/mcp_query_variations.test.ts[2m > [22mMCP query actions - parameter variations[2m > [22mpagination variations[2m > [22mshould paginate with offset
[31m[1mAssertionError[22m: expected [] to have a length of 5 but got +0[39m

[32m- Expected[39m
[31m+ Received[39m

[32m- 5[39m
[31m+ 0[39m

[36m [2m‚ùØ[22m tests/integration/mcp_query_variations.test.ts:[2m86:24[22m[39m
    [90m 84| [39m        [33m.[39m[34mrange[39m(offset[33m,[39m offset [33m+[39m limit [33m-[39m [34m1[39m)[33m;[39m
    [90m 85| [39m
    [90m 86| [39m      [34mexpect[39m(entities)[33m.[39m[34mtoHaveLength[39m(limit)[33m;[39m
    [90m   | [39m                       [31m^[39m
    [90m 87| [39m    })[33m;[39m
    [90m 88| [39m

[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[28/64]‚éØ[22m[39m

[41m[1m FAIL [22m[49m tests/integration/mcp_query_variations.test.ts[2m > [22mMCP query actions - parameter variations[2m > [22mpagination variations[2m > [22mshould paginate with min limit (1)
[31m[1mAssertionError[22m: expected [] to have a length of 1 but got +0[39m

[32m- Expected[39m
[31m+ Received[39m

[32m- 1[39m
[31m+ 0[39m

[36m [2m‚ùØ[22m tests/integration/mcp_query_variations.test.ts:[2m98:24[22m[39m
    [90m 96| [39m        [33m.[39m[34mlimit[39m([34m1[39m)[33m;[39m
    [90m 97| [39m
    [90m 98| [39m      [34mexpect[39m(entities)[33m.[39m[34mtoHaveLength[39m([34m1[39m)[33m;[39m
    [90m   | [39m                       [31m^[39m
    [90m 99| [39m    })[33m;[39m
    [90m100| [39m

[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[29/64]‚éØ[22m[39m

[41m[1m FAIL [22m[49m tests/integration/mcp_query_variations.test.ts[2m > [22mMCP query actions - parameter variations[2m > [22mfiltering variations[2m > [22mshould filter by user_id: null
[31m[1mAssertionError[22m: expected false to be true // Object.is equality[39m

[32m- Expected[39m
[31m+ Received[39m

[32m- true[39m
[31m+ false[39m

[36m [2m‚ùØ[22m tests/integration/mcp_query_variations.test.ts:[2m201:63[22m[39m
    [90m199| [39m        [33m.[39m[34mis[39m([32m"user_id"[39m[33m,[39m [35mnull[39m)[33m;[39m
    [90m200| [39m
    [90m201| [39m      expect(entities!.some((e) => e.entity_id === entityId)).toBe(tru‚Ä¶
    [90m   | [39m                                                              [31m^[39m
    [90m202| [39m    })[33m;[39m
    [90m203| [39m

[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[30/64]‚éØ[22m[39m

[41m[1m FAIL [22m[49m tests/integration/mcp_query_variations.test.ts[2m > [22mMCP query actions - parameter variations[2m > [22mfiltering variations[2m > [22mshould search by canonical_name with ILIKE
[31m[1mTypeError[22m: __vite_ssr_import_1__.supabase.from(...).select(...).eq(...).ilike is not a function[39m
[36m [2m‚ùØ[22m tests/integration/mcp_query_variations.test.ts:[2m209:10[22m[39m
    [90m207| [39m        [33m.[39m[34mselect[39m([32m"*"[39m)
    [90m208| [39m        [33m.[39m[34meq[39m([32m"user_id"[39m[33m,[39m testUserId)
    [90m209| [39m        [33m.[39m[34milike[39m([32m"canonical_name"[39m[33m,[39m [32m"%Task%"[39m)[33m;[39m
    [90m   | [39m         [31m^[39m
    [90m210| [39m
    [90m211| [39m      [34mexpect[39m(entities[33m![39m[33m.[39mlength)[33m.[39m[34mtoBeGreaterThan[39m([34m0[39m)[33m;[39m

[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[31/64]‚éØ[22m[39m

[41m[1m FAIL [22m[49m tests/integration/mcp_query_variations.test.ts[2m > [22mMCP query actions - parameter variations[2m > [22mfiltering variations[2m > [22mshould combine multiple filters
[31m[1mTypeError[22m: __vite_ssr_import_1__.supabase.from(...).select(...).eq(...).eq(...).ilike is not a function[39m
[36m [2m‚ùØ[22m tests/integration/mcp_query_variations.test.ts:[2m220:10[22m[39m
    [90m218| [39m        [33m.[39m[34meq[39m([32m"entity_type"[39m[33m,[39m [32m"task"[39m)
    [90m219| [39m        [33m.[39m[34meq[39m([32m"user_id"[39m[33m,[39m testUserId)
    [90m220| [39m        [33m.[39m[34milike[39m([32m"canonical_name"[39m[33m,[39m [32m"%Task%"[39m)[33m;[39m
    [90m   | [39m         [31m^[39m
    [90m221| [39m
    [90m222| [39m      expect(entities!.every((e) => e.entity_type === "task")).toBe(tr‚Ä¶

[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[32/64]‚éØ[22m[39m

[41m[1m FAIL [22m[49m tests/integration/mcp_query_variations.test.ts[2m > [22mMCP query actions - parameter variations[2m > [22msorting variations[2m > [22mshould sort by canonical_name
[31m[1mTypeError[22m: Cannot read properties of null (reading 'length')[39m
[36m [2m‚ùØ[22m tests/integration/mcp_query_variations.test.ts:[2m268:37[22m[39m
    [90m266| [39m
    [90m267| [39m      [90m// Verify sorted order[39m
    [90m268| [39m      [35mfor[39m ([35mlet[39m i [33m=[39m [34m1[39m[33m;[39m i [33m<[39m entities[33m![39m[33m.[39mlength[33m;[39m i[33m++[39m) {
    [90m   | [39m                                    [31m^[39m
    [90m269| [39m        [34mexpect[39m(
    [90m270| [39m          entities![i].canonical_name >= entities![i - 1].canonical_na‚Ä¶

[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[33/64]‚éØ[22m[39m

[41m[1m FAIL [22m[49m tests/integration/mcp_query_variations.test.ts[2m > [22mMCP query actions - parameter variations[2m > [22msorting variations[2m > [22mshould sort by multiple columns
[31m[1mTypeError[22m: Cannot read properties of null (reading 'length')[39m
[36m [2m‚ùØ[22m tests/integration/mcp_query_variations.test.ts:[2m286:24[22m[39m
    [90m284| [39m
    [90m285| [39m      [90m// Verify entities are returned[39m
    [90m286| [39m      [34mexpect[39m(entities[33m![39m[33m.[39mlength)[33m.[39m[34mtoBeGreaterThan[39m([34m0[39m)[33m;[39m
    [90m   | [39m                       [31m^[39m
    [90m287| [39m    })[33m;[39m
    [90m288| [39m

[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[34/64]‚éØ[22m[39m

[41m[1m FAIL [22m[49m tests/integration/mcp_query_variations.test.ts[2m > [22mMCP query actions - parameter variations[2m > [22mcombined pagination, filtering, and sorting[2m > [22mshould combine all query operations
[31m[1mTypeError[22m: __vite_ssr_import_1__.supabase.from(...).select(...).eq(...).eq(...).ilike is not a function[39m
[36m [2m‚ùØ[22m tests/integration/mcp_query_variations.test.ts:[2m320:10[22m[39m
    [90m318| [39m        [33m.[39m[34meq[39m([32m"entity_type"[39m[33m,[39m [32m"task"[39m)
    [90m319| [39m        [33m.[39m[34meq[39m([32m"user_id"[39m[33m,[39m testUserId)
    [90m320| [39m        [33m.[39m[34milike[39m([32m"canonical_name"[39m[33m,[39m [32m"%Task%"[39m)
    [90m   | [39m         [31m^[39m
    [90m321| [39m        [33m.[39m[34morder[39m([32m"canonical_name"[39m)
    [90m322| [39m        [33m.[39m[34mlimit[39m(limit)

[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[35/64]‚éØ[22m[39m

[41m[1m FAIL [22m[49m tests/integration/mcp_query_variations.test.ts[2m > [22mMCP query actions - parameter variations[2m > [22minclude_merged variations[2m > [22mshould exclude merged entities by default
[31m[1mTypeError[22m: Cannot read properties of null (reading 'every')[39m
[36m [2m‚ùØ[22m tests/integration/mcp_query_variations.test.ts:[2m348:24[22m[39m
    [90m346| [39m
    [90m347| [39m      [90m// All entities should not be merged[39m
    [90m348| [39m      expect(entities!.every((e) => e.merged_into === null)).toBe(true‚Ä¶
    [90m   | [39m                       [31m^[39m
    [90m349| [39m    })[33m;[39m
    [90m350| [39m

[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[36/64]‚éØ[22m[39m

[41m[1m FAIL [22m[49m tests/integration/mcp_relationship_variations.test.ts[2m > [22mMCP relationship actions - parameter variations[2m > [22mcreate_relationship variations[2m > [22mshould create PART_OF relationship
[31m[1mTypeError[22m: Cannot read properties of null (reading 'relationship_type')[39m
[36m [2m‚ùØ[22m tests/integration/mcp_relationship_variations.test.ts:[2m71:28[22m[39m
    [90m 69| [39m
    [90m 70| [39m      [34mexpect[39m(relationship)[33m.[39m[34mtoBeDefined[39m()[33m;[39m
    [90m 71| [39m      [34mexpect[39m(relationship[33m![39m[33m.[39mrelationship_type)[33m.[39m[34mtoBe[39m([32m"PART_OF"[39m)[33m;[39m
    [90m   | [39m                           [31m^[39m
    [90m 72| [39m    })[33m;[39m
    [90m 73| [39m

[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[37/64]‚éØ[22m[39m

[41m[1m FAIL [22m[49m tests/integration/mcp_relationship_variations.test.ts[2m > [22mMCP relationship actions - parameter variations[2m > [22mcreate_relationship variations[2m > [22mshould create CORRECTS relationship
[31m[1mTypeError[22m: Cannot read properties of null (reading 'relationship_type')[39m
[36m [2m‚ùØ[22m tests/integration/mcp_relationship_variations.test.ts:[2m89:28[22m[39m
    [90m 87| [39m        [33m.[39m[34msingle[39m()[33m;[39m
    [90m 88| [39m
    [90m 89| [39m      [34mexpect[39m(relationship[33m![39m[33m.[39mrelationship_type)[33m.[39m[34mtoBe[39m([32m"CORRECTS"[39m)[33m;[39m
    [90m   | [39m                           [31m^[39m
    [90m 90| [39m    })[33m;[39m
    [90m 91| [39m

[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[38/64]‚éØ[22m[39m

[41m[1m FAIL [22m[49m tests/integration/mcp_relationship_variations.test.ts[2m > [22mMCP relationship actions - parameter variations[2m > [22mcreate_relationship variations[2m > [22mshould create REFERS_TO relationship
[31m[1mTypeError[22m: Cannot read properties of null (reading 'relationship_type')[39m
[36m [2m‚ùØ[22m tests/integration/mcp_relationship_variations.test.ts:[2m107:28[22m[39m
    [90m105| [39m        [33m.[39m[34msingle[39m()[33m;[39m
    [90m106| [39m
    [90m107| [39m      [34mexpect[39m(relationship[33m![39m[33m.[39mrelationship_type)[33m.[39m[34mtoBe[39m([32m"REFERS_TO"[39m)[33m;[39m
    [90m   | [39m                           [31m^[39m
    [90m108| [39m    })[33m;[39m
    [90m109| [39m

[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[39/64]‚éØ[22m[39m

[41m[1m FAIL [22m[49m tests/integration/mcp_relationship_variations.test.ts[2m > [22mMCP relationship actions - parameter variations[2m > [22mcreate_relationship variations[2m > [22mshould create SETTLES relationship
[31m[1mTypeError[22m: Cannot read properties of null (reading 'relationship_type')[39m
[36m [2m‚ùØ[22m tests/integration/mcp_relationship_variations.test.ts:[2m125:28[22m[39m
    [90m123| [39m        [33m.[39m[34msingle[39m()[33m;[39m
    [90m124| [39m
    [90m125| [39m      [34mexpect[39m(relationship[33m![39m[33m.[39mrelationship_type)[33m.[39m[34mtoBe[39m([32m"SETTLES"[39m)[33m;[39m
    [90m   | [39m                           [31m^[39m
    [90m126| [39m    })[33m;[39m
    [90m127| [39m

[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[40/64]‚éØ[22m[39m

[41m[1m FAIL [22m[49m tests/integration/mcp_relationship_variations.test.ts[2m > [22mMCP relationship actions - parameter variations[2m > [22mcreate_relationship variations[2m > [22mshould create DUPLICATE_OF relationship
[31m[1mTypeError[22m: Cannot read properties of null (reading 'relationship_type')[39m
[36m [2m‚ùØ[22m tests/integration/mcp_relationship_variations.test.ts:[2m143:28[22m[39m
    [90m141| [39m        [33m.[39m[34msingle[39m()[33m;[39m
    [90m142| [39m
    [90m143| [39m      [34mexpect[39m(relationship[33m![39m[33m.[39mrelationship_type)[33m.[39m[34mtoBe[39m([32m"DUPLICATE_OF"[39m)[33m;[39m
    [90m   | [39m                           [31m^[39m
    [90m144| [39m    })[33m;[39m
    [90m145| [39m

[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[41/64]‚éØ[22m[39m

[41m[1m FAIL [22m[49m tests/integration/mcp_relationship_variations.test.ts[2m > [22mMCP relationship actions - parameter variations[2m > [22mcreate_relationship variations[2m > [22mshould create DEPENDS_ON relationship
[31m[1mTypeError[22m: Cannot read properties of null (reading 'relationship_type')[39m
[36m [2m‚ùØ[22m tests/integration/mcp_relationship_variations.test.ts:[2m161:28[22m[39m
    [90m159| [39m        [33m.[39m[34msingle[39m()[33m;[39m
    [90m160| [39m
    [90m161| [39m      [34mexpect[39m(relationship[33m![39m[33m.[39mrelationship_type)[33m.[39m[34mtoBe[39m([32m"DEPENDS_ON"[39m)[33m;[39m
    [90m   | [39m                           [31m^[39m
    [90m162| [39m    })[33m;[39m
    [90m163| [39m

[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[42/64]‚éØ[22m[39m

[41m[1m FAIL [22m[49m tests/integration/mcp_relationship_variations.test.ts[2m > [22mMCP relationship actions - parameter variations[2m > [22mcreate_relationship variations[2m > [22mshould create SUPERSEDES relationship
[31m[1mTypeError[22m: Cannot read properties of null (reading 'relationship_type')[39m
[36m [2m‚ùØ[22m tests/integration/mcp_relationship_variations.test.ts:[2m179:28[22m[39m
    [90m177| [39m        [33m.[39m[34msingle[39m()[33m;[39m
    [90m178| [39m
    [90m179| [39m      [34mexpect[39m(relationship[33m![39m[33m.[39mrelationship_type)[33m.[39m[34mtoBe[39m([32m"SUPERSEDES"[39m)[33m;[39m
    [90m   | [39m                           [31m^[39m
    [90m180| [39m    })[33m;[39m
    [90m181| [39m

[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[43/64]‚éØ[22m[39m

[41m[1m FAIL [22m[49m tests/integration/mcp_relationship_variations.test.ts[2m > [22mMCP relationship actions - parameter variations[2m > [22mcreate_relationship variations[2m > [22mshould create EMBEDS relationship
[31m[1mTypeError[22m: Cannot read properties of null (reading 'relationship_type')[39m
[36m [2m‚ùØ[22m tests/integration/mcp_relationship_variations.test.ts:[2m197:28[22m[39m
    [90m195| [39m        [33m.[39m[34msingle[39m()[33m;[39m
    [90m196| [39m
    [90m197| [39m      [34mexpect[39m(relationship[33m![39m[33m.[39mrelationship_type)[33m.[39m[34mtoBe[39m([32m"EMBEDS"[39m)[33m;[39m
    [90m   | [39m                           [31m^[39m
    [90m198| [39m    })[33m;[39m
    [90m199| [39m

[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[44/64]‚éØ[22m[39m

[41m[1m FAIL [22m[49m tests/integration/mcp_relationship_variations.test.ts[2m > [22mMCP relationship actions - parameter variations[2m > [22mcreate_relationship variations[2m > [22mshould create relationship with optional metadata
[31m[1mTypeError[22m: Cannot read properties of null (reading 'observed_properties')[39m
[36m [2m‚ùØ[22m tests/integration/mcp_relationship_variations.test.ts:[2m222:28[22m[39m
    [90m220| [39m        [33m.[39m[34msingle[39m()[33m;[39m
    [90m221| [39m
    [90m222| [39m      [34mexpect[39m(relationship[33m![39m[33m.[39mobserved_properties)[33m.[39m[34mtoEqual[39m(metadata)[33m;[39m
    [90m   | [39m                           [31m^[39m
    [90m223| [39m    })[33m;[39m
    [90m224| [39m  })[33m;[39m

[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[45/64]‚éØ[22m[39m

[41m[1m FAIL [22m[49m tests/integration/mcp_relationship_variations.test.ts[2m > [22mMCP relationship actions - parameter variations[2m > [22mlist_relationships variations[2m > [22mshould list relationships with direction: outbound
[31m[1mAssertionError[22m: expected 0 to be greater than 0[39m
[36m [2m‚ùØ[22m tests/integration/mcp_relationship_variations.test.ts:[2m243:37[22m[39m
    [90m241| [39m        [33m.[39m[34meq[39m([32m"source_entity_id"[39m[33m,[39m entity1Id)[33m;[39m
    [90m242| [39m
    [90m243| [39m      [34mexpect[39m(relationships[33m![39m[33m.[39mlength)[33m.[39m[34mtoBeGreaterThan[39m([34m0[39m)[33m;[39m
    [90m   | [39m                                    [31m^[39m
    [90m244| [39m      [34mexpect[39m(relationships[33m![39m[[34m0[39m][33m.[39msource_entity_id)[33m.[39m[34mtoBe[39m(entity1Id)[33m;[39m
    [90m245| [39m    })[33m;[39m

[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[46/64]‚éØ[22m[39m

[41m[1m FAIL [22m[49m tests/integration/mcp_relationship_variations.test.ts[2m > [22mMCP relationship actions - parameter variations[2m > [22mlist_relationships variations[2m > [22mshould list relationships with direction: inbound
[31m[1mAssertionError[22m: expected 0 to be greater than 0[39m
[36m [2m‚ùØ[22m tests/integration/mcp_relationship_variations.test.ts:[2m263:37[22m[39m
    [90m261| [39m        [33m.[39m[34meq[39m([32m"target_entity_id"[39m[33m,[39m entity2Id)[33m;[39m
    [90m262| [39m
    [90m263| [39m      [34mexpect[39m(relationships[33m![39m[33m.[39mlength)[33m.[39m[34mtoBeGreaterThan[39m([34m0[39m)[33m;[39m
    [90m   | [39m                                    [31m^[39m
    [90m264| [39m      [34mexpect[39m(relationships[33m![39m[[34m0[39m][33m.[39mtarget_entity_id)[33m.[39m[34mtoBe[39m(entity2Id)[33m;[39m
    [90m265| [39m    })[33m;[39m

[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[47/64]‚éØ[22m[39m

[41m[1m FAIL [22m[49m tests/integration/mcp_relationship_variations.test.ts[2m > [22mMCP relationship actions - parameter variations[2m > [22mlist_relationships variations[2m > [22mshould list relationships with direction: both
[31m[1mAssertionError[22m: expected 0 to be greater than 0[39m
[36m [2m‚ùØ[22m tests/integration/mcp_relationship_variations.test.ts:[2m297:32[22m[39m
    [90m295| [39m        [33m.[39m[34meq[39m([32m"target_entity_id"[39m[33m,[39m entity1Id)[33m;[39m
    [90m296| [39m
    [90m297| [39m      [34mexpect[39m(outbound[33m![39m[33m.[39mlength)[33m.[39m[34mtoBeGreaterThan[39m([34m0[39m)[33m;[39m
    [90m   | [39m                               [31m^[39m
    [90m298| [39m      [34mexpect[39m(inbound[33m![39m[33m.[39mlength)[33m.[39m[34mtoBeGreaterThan[39m([34m0[39m)[33m;[39m
    [90m299| [39m    })[33m;[39m

[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[48/64]‚éØ[22m[39m

[41m[1m FAIL [22m[49m tests/integration/mcp_relationship_variations.test.ts[2m > [22mMCP relationship actions - parameter variations[2m > [22mget_relationship_snapshot variations[2m > [22mshould retrieve relationship snapshot
[31m[1mTypeError[22m: Cannot read properties of null (reading 'relationship_type')[39m
[36m [2m‚ùØ[22m tests/integration/mcp_relationship_variations.test.ts:[2m352:28[22m[39m
    [90m350| [39m
    [90m351| [39m      [34mexpect[39m(relationship)[33m.[39m[34mtoBeDefined[39m()[33m;[39m
    [90m352| [39m      [34mexpect[39m(relationship[33m![39m[33m.[39mrelationship_type)[33m.[39m[34mtoBe[39m([32m"REFERS_TO"[39m)[33m;[39m
    [90m   | [39m                           [31m^[39m
    [90m353| [39m    })[33m;[39m
    [90m354| [39m  })[33m;[39m

[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[49/64]‚éØ[22m[39m

[41m[1m FAIL [22m[49m tests/integration/mcp_resource_variations.test.ts[2m > [22mMCP resource actions - parameter variations[2m > [22mlist_observations variations[2m > [22mshould list observations for entity_id
[31m[1mAssertionError[22m: expected 0 to be greater than 0[39m
[36m [2m‚ùØ[22m tests/integration/mcp_resource_variations.test.ts:[2m69:36[22m[39m
    [90m 67| [39m        [33m.[39m[34meq[39m([32m"entity_id"[39m[33m,[39m entityId)[33m;[39m
    [90m 68| [39m
    [90m 69| [39m      [34mexpect[39m(observations[33m![39m[33m.[39mlength)[33m.[39m[34mtoBeGreaterThan[39m([34m0[39m)[33m;[39m
    [90m   | [39m                                   [31m^[39m
    [90m 70| [39m    })[33m;[39m
    [90m 71| [39m

[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[50/64]‚éØ[22m[39m

[41m[1m FAIL [22m[49m tests/integration/mcp_resource_variations.test.ts[2m > [22mMCP resource actions - parameter variations[2m > [22mlist_observations variations[2m > [22mshould paginate observations with limit
[31m[1mAssertionError[22m: expected [] to have a length of 5 but got +0[39m

[32m- Expected[39m
[31m+ Received[39m

[32m- 5[39m
[31m+ 0[39m

[36m [2m‚ùØ[22m tests/integration/mcp_resource_variations.test.ts:[2m108:28[22m[39m
    [90m106| [39m        [33m.[39m[34mlimit[39m(limit)[33m;[39m
    [90m107| [39m
    [90m108| [39m      [34mexpect[39m(observations)[33m.[39m[34mtoHaveLength[39m(limit)[33m;[39m
    [90m   | [39m                           [31m^[39m
    [90m109| [39m    })[33m;[39m
    [90m110| [39m

[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[51/64]‚éØ[22m[39m

[41m[1m FAIL [22m[49m tests/integration/mcp_resource_variations.test.ts[2m > [22mMCP resource actions - parameter variations[2m > [22mlist_observations variations[2m > [22mshould paginate observations with offset
[31m[1mAssertionError[22m: expected [] to have a length of 5 but got +0[39m

[32m- Expected[39m
[31m+ Received[39m

[32m- 5[39m
[31m+ 0[39m

[36m [2m‚ùØ[22m tests/integration/mcp_resource_variations.test.ts:[2m150:28[22m[39m
    [90m148| [39m        [33m.[39m[34mrange[39m(offset[33m,[39m offset [33m+[39m limit [33m-[39m [34m1[39m)[33m;[39m
    [90m149| [39m
    [90m150| [39m      [34mexpect[39m(observations)[33m.[39m[34mtoHaveLength[39m(limit)[33m;[39m
    [90m   | [39m                           [31m^[39m
    [90m151| [39m    })[33m;[39m
    [90m152| [39m  })[33m;[39m

[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[52/64]‚éØ[22m[39m

[41m[1m FAIL [22m[49m tests/integration/mcp_resource_variations.test.ts[2m > [22mMCP resource actions - parameter variations[2m > [22mretrieve_field_provenance variations[2m > [22mshould retrieve provenance chain for specific field
[31m[1mTypeError[22m: Cannot read properties of null (reading 'length')[39m
[36m [2m‚ùØ[22m tests/integration/mcp_resource_variations.test.ts:[2m200:28[22m[39m
    [90m198| [39m        [33m.[39m[34morder[39m([32m"priority"[39m)[33m;[39m
    [90m199| [39m
    [90m200| [39m      [34mexpect[39m(observations[33m![39m[33m.[39mlength)[33m.[39m[34mtoBeGreaterThan[39m([34m0[39m)[33m;[39m
    [90m   | [39m                           [31m^[39m
    [90m201| [39m      expect(observations!.some((o) => o.observed_properties.title)).t‚Ä¶
    [90m202| [39m    })[33m;[39m

[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[53/64]‚éØ[22m[39m

[41m[1m FAIL [22m[49m tests/integration/mcp_resource_variations.test.ts[2m > [22mMCP resource actions - parameter variations[2m > [22mretrieve_field_provenance variations[2m > [22mshould trace field through multiple observations
[31m[1mAssertionError[22m: Target cannot be null or undefined.[39m
[36m [2m‚ùØ[22m tests/integration/mcp_resource_variations.test.ts:[2m257:28[22m[39m
    [90m255| [39m        [33m.[39m[34morder[39m([32m"priority"[39m)[33m;[39m
    [90m256| [39m
    [90m257| [39m      [34mexpect[39m(observations)[33m.[39m[34mtoHaveLength[39m([34m3[39m)[33m;[39m
    [90m   | [39m                           [31m^[39m
    [90m258| [39m      expect(observations![0].observed_properties.title).toBe("Version‚Ä¶
    [90m259| [39m      expect(observations![1].observed_properties.title).toBe("Version‚Ä¶

[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[54/64]‚éØ[22m[39m

[41m[1m FAIL [22m[49m tests/integration/mcp_resource_variations.test.ts[2m > [22mMCP resource actions - parameter variations[2m > [22mlist_timeline_events variations[2m > [22mshould filter timeline events by date range
[31m[1mAssertionError[22m: expected false to be true // Object.is equality[39m

[32m- Expected[39m
[31m+ Received[39m

[32m- true[39m
[31m+ false[39m

[36m [2m‚ùØ[22m tests/integration/mcp_resource_variations.test.ts:[2m294:37[22m[39m
    [90m292| [39m        [33m.[39m[34mlte[39m([32m"event_date"[39m[33m,[39m endDate)[33m;[39m
    [90m293| [39m
    [90m294| [39m      [34mexpect[39m([33mArray[39m[33m.[39m[34misArray[39m(events))[33m.[39m[34mtoBe[39m([35mtrue[39m)[33m;[39m
    [90m   | [39m                                    [31m^[39m
    [90m295| [39m    })[33m;[39m
    [90m296| [39m

[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[55/64]‚éØ[22m[39m

[41m[1m FAIL [22m[49m tests/integration/mcp_schema_variations.test.ts[2m > [22mMCP schema actions - parameter variations[2m > [22mregister_schema variations[2m > [22mshould register multiple schema versions
[31m[1mAssertionError[22m: expected 1 to be true // Object.is equality[39m

[32m- Expected:[39m 
true

[31m+ Received:[39m 
1

[36m [2m‚ùØ[22m tests/integration/mcp_schema_variations.test.ts:[2m237:34[22m[39m
    [90m235| [39m      [34mexpect[39m(schemas[33m![39m[[34m0[39m][33m.[39mschema_version)[33m.[39m[34mtoBe[39m([32m"1.0.0"[39m)[33m;[39m
    [90m236| [39m      [34mexpect[39m(schemas[33m![39m[[34m1[39m][33m.[39mschema_version)[33m.[39m[34mtoBe[39m([32m"2.0.0"[39m)[33m;[39m
    [90m237| [39m      [34mexpect[39m(schemas[33m![39m[[34m1[39m][33m.[39mactive)[33m.[39m[34mtoBe[39m([35mtrue[39m)[33m;[39m
    [90m   | [39m                                 [31m^[39m
    [90m238| [39m
    [90m239| [39m      [90m// Cleanup[39m

[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[56/64]‚éØ[22m[39m

[41m[1m FAIL [22m[49m tests/integration/mcp_schema_variations.test.ts[2m > [22mMCP schema actions - parameter variations[2m > [22manalyze_schema_candidates variations[2m > [22mshould analyze raw_fragments for schema candidates
[31m[1mTypeError[22m: Cannot read properties of null (reading 'length')[39m
[36m [2m‚ùØ[22m tests/integration/mcp_schema_variations.test.ts:[2m370:25[22m[39m
    [90m368| [39m        [33m.[39m[34meq[39m([32m"user_id"[39m[33m,[39m testUserId)[33m;[39m
    [90m369| [39m
    [90m370| [39m      [34mexpect[39m(fragments[33m![39m[33m.[39mlength)[33m.[39m[34mtoBeGreaterThan[39m([34m0[39m)[33m;[39m
    [90m   | [39m                        [31m^[39m
    [90m371| [39m
    [90m372| [39m      [90m// Cleanup raw_fragments[39m

[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[57/64]‚éØ[22m[39m

[41m[1m FAIL [22m[49m tests/integration/mcp_store_variations.test.ts[2m > [22mMCP store action - parameter variations[2m > [22mstore_structured variations[2m > [22mshould store entities with minimal required fields
[31m[1mAssertionError[22m: Target cannot be null or undefined.[39m
[36m [2m‚ùØ[22m tests/integration/mcp_store_variations.test.ts:[2m62:28[22m[39m
    [90m 60| [39m        [33m.[39m[34mselect[39m()[33m;[39m
    [90m 61| [39m
    [90m 62| [39m      [34mexpect[39m(observations)[33m.[39m[34mtoHaveLength[39m([34m1[39m)[33m;[39m
    [90m   | [39m                           [31m^[39m
    [90m 63| [39m      [34mexpect[39m(observations[33m![39m[[34m0[39m][33m.[39mentity_type)[33m.[39m[34mtoBe[39m([32m"task"[39m)[33m;[39m
    [90m 64| [39m

[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[58/64]‚éØ[22m[39m

[41m[1m FAIL [22m[49m tests/integration/mcp_store_variations.test.ts[2m > [22mMCP store action - parameter variations[2m > [22mstore_structured variations[2m > [22mshould store entities with optional user_id as null
[31m[1mAssertionError[22m: Target cannot be null or undefined.[39m
[36m [2m‚ùØ[22m tests/integration/mcp_store_variations.test.ts:[2m111:28[22m[39m
    [90m109| [39m        [33m.[39m[34mselect[39m()[33m;[39m
    [90m110| [39m
    [90m111| [39m      [34mexpect[39m(observations)[33m.[39m[34mtoHaveLength[39m([34m1[39m)[33m;[39m
    [90m   | [39m                           [31m^[39m
    [90m112| [39m      [34mexpect[39m(observations[33m![39m[[34m0[39m][33m.[39muser_id)[33m.[39m[34mtoBeNull[39m()[33m;[39m
    [90m113| [39m    })[33m;[39m

[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[59/64]‚éØ[22m[39m

[41m[1m FAIL [22m[49m tests/integration/mcp_store_variations.test.ts[2m > [22mMCP store action - parameter variations[2m > [22mstore_structured variations[2m > [22mshould store entities with optional user_id as default UUID
[31m[1mAssertionError[22m: Target cannot be null or undefined.[39m
[36m [2m‚ùØ[22m tests/integration/mcp_store_variations.test.ts:[2m159:28[22m[39m
    [90m157| [39m        [33m.[39m[34mselect[39m()[33m;[39m
    [90m158| [39m
    [90m159| [39m      [34mexpect[39m(observations)[33m.[39m[34mtoHaveLength[39m([34m1[39m)[33m;[39m
    [90m   | [39m                           [31m^[39m
    [90m160| [39m      [34mexpect[39m(observations[33m![39m[[34m0[39m][33m.[39muser_id)[33m.[39m[34mtoBe[39m(defaultUserId)[33m;[39m
    [90m161| [39m    })[33m;[39m

[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[60/64]‚éØ[22m[39m

[41m[1m FAIL [22m[49m tests/integration/mcp_store_variations.test.ts[2m > [22mMCP store action - parameter variations[2m > [22mstore_structured variations[2m > [22mshould store entities with custom source_priority
[31m[1mAssertionError[22m: expected { Object (message) } to be null[39m

[32m- Expected:[39m 
null

[31m+ Received:[39m 
{
  "message": "table sources has no column named priority",
}

[36m [2m‚ùØ[22m tests/integration/mcp_store_variations.test.ts:[2m186:27[22m[39m
    [90m184| [39m        [33m.[39m[34msingle[39m()[33m;[39m
    [90m185| [39m
    [90m186| [39m      [34mexpect[39m(sourceError)[33m.[39m[34mtoBeNull[39m()[33m;[39m
    [90m   | [39m                          [31m^[39m
    [90m187| [39m      [34mexpect[39m(source)[33m.[39m[34mtoBeDefined[39m()[33m;[39m
    [90m188| [39m

[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[61/64]‚éØ[22m[39m

[41m[1m FAIL [22m[49m tests/integration/mcp_store_variations.test.ts[2m > [22mMCP store action - parameter variations[2m > [22mstore_structured variations[2m > [22mshould deduplicate sources with same content_hash
[31m[1mAssertionError[22m: expected undefined to be '23505' // Object.is equality[39m

[32m- Expected:[39m 
"23505"

[31m+ Received:[39m 
undefined

[36m [2m‚ùØ[22m tests/integration/mcp_store_variations.test.ts:[2m260:27[22m[39m
    [90m258| [39m      [90m// Should fail due to unique constraint on content_hash[39m
    [90m259| [39m      [34mexpect[39m(error)[33m.[39m[34mtoBeDefined[39m()[33m;[39m
    [90m260| [39m      [34mexpect[39m(error[33m?.[39mcode)[33m.[39m[34mtoBe[39m([32m"23505"[39m)[33m;[39m [90m// Unique violation[39m
    [90m   | [39m                          [31m^[39m
    [90m261| [39m    })[33m;[39m
    [90m262| [39m

[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[62/64]‚éØ[22m[39m

[41m[1m FAIL [22m[49m tests/integration/mcp_store_variations.test.ts[2m > [22mMCP store action - parameter variations[2m > [22mstore_unstructured variations[2m > [22mshould store unstructured data with file_content (base64)
[31m[1mError[22m: ENOENT: no such file or directory, open '/Users/markmhendrickson/repos/neotoma/tests/fixtures/sample_invoice.pdf'[39m
[36m [2m‚ùØ[22m tests/integration/mcp_store_variations.test.ts:[2m301:27[22m[39m
    [90m299| [39m    it("should store unstructured data with file_content (base64)", as‚Ä¶
    [90m300| [39m      const testFile = join(process.cwd(), "tests/fixtures/sample_invo‚Ä¶
    [90m301| [39m      [35mconst[39m fileContent [33m=[39m [34mreadFileSync[39m(testFile)[33m;[39m
    [90m   | [39m                          [31m^[39m
    [90m302| [39m      [35mconst[39m base64Content [33m=[39m fileContent[33m.[39m[34mtoString[39m([32m"base64"[39m)[33m;[39m
    [90m303| [39m

[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[63/64]‚éØ[22m[39m

[41m[1m FAIL [22m[49m tests/integration/mcp_store_variations.test.ts[2m > [22mMCP store action - parameter variations[2m > [22merror cases[2m > [22mshould reject invalid source_id foreign key
[31m[1mAssertionError[22m: expected undefined to be '23503' // Object.is equality[39m

[32m- Expected:[39m 
"23503"

[31m+ Received:[39m 
undefined

[36m [2m‚ùØ[22m tests/integration/mcp_store_variations.test.ts:[2m442:27[22m[39m
    [90m440| [39m
    [90m441| [39m      [34mexpect[39m(error)[33m.[39m[34mtoBeDefined[39m()[33m;[39m
    [90m442| [39m      [34mexpect[39m(error[33m?.[39mcode)[33m.[39m[34mtoBe[39m([32m"23503"[39m)[33m;[39m [90m// Foreign key violation[39m
    [90m   | [39m                          [31m^[39m
    [90m443| [39m    })[33m;[39m
    [90m444| [39m  })[33m;[39m

[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[64/64]‚éØ[22m[39m


[2m Test Files [22m [1m[31m8 failed[39m[22m[2m | [22m[1m[32m3 passed[39m[22m[2m | [22m[33m1 skipped[39m[90m (12)[39m
[2m      Tests [22m [1m[31m64 failed[39m[22m[2m | [22m[1m[32m114 passed[39m[22m[2m | [22m[33m22 skipped[39m[90m (200)[39m
[2m   Start at [22m 18:03:33
[2m   Duration [22m 2.04s[2m (transform 1.74s, setup 2.97s, import 4.18s, tests 1.61s, environment 1ms)[22m

