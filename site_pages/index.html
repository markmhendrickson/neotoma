<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Neotoma | Truth layer for persistent agent memory</title>
    <meta name="description" content="Neotoma is a truth layer for persistent agent memory. Install with npm and configure MCP for Claude, Cursor, or Codex. Deterministic, queryable entities and provenance." />
    <link rel="canonical" href="https://markmhendrickson.github.io/neotoma/" />
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://markmhendrickson.github.io/neotoma/" />
    <meta property="og:title" content="Neotoma | Truth layer for persistent agent memory" />
    <meta property="og:description" content="Neotoma is a truth layer for persistent agent memory. Install with npm and configure MCP for Claude, Cursor, or Codex. Deterministic, queryable entities and provenance." />
    <meta property="og:image" content="https://markmhendrickson.com/images/posts/truth-layer-agent-memory-hero.png" />
    <meta property="og:locale" content="en" />
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="Neotoma | Truth layer for persistent agent memory" />
    <meta name="twitter:description" content="Neotoma is a truth layer for persistent agent memory. Install with npm and configure MCP for Claude, Cursor, or Codex. Deterministic, queryable entities and provenance." />
    <meta name="twitter:image" content="https://markmhendrickson.com/images/posts/truth-layer-agent-memory-hero.png" />
    <script type="application/ld+json">{"@context":"https://schema.org","@type":"WebPage","name":"Neotoma | Truth layer for persistent agent memory","description":"Neotoma is a truth layer for persistent agent memory. Install with npm and configure MCP for Claude, Cursor, or Codex. Deterministic, queryable entities and provenance.","url":"https://markmhendrickson.github.io/neotoma/","publisher":{"@type":"Organization","name":"Neotoma"}}</script>
    <link rel="icon" href="favicon.svg" type="image/svg+xml" />
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
      body { margin: 0; }
      .post-prose a { color: #000; border-bottom: 1px solid #000; text-decoration: none; }
      .post-prose a:hover { border-bottom-color: transparent; }
      .post-prose code { background: #f3f4f6; padding: 0.125rem 0.25rem; border-radius: 0.25rem; }
    </style>
  </head>
  <body>
    <div class="min-h-screen bg-white text-neutral-800"><main class="min-w-0"><div class="max-w-[40em] mx-auto px-4 py-10 md:py-16"><article class="post-prose"><h1 class="text-[24px] font-medium tracking-[-0.02em] mb-4 mt-0">Get started with Neotoma</h1><p class="text-[15px] leading-7 mb-4"><a href="https://github.com/markmhendrickson/neotoma">Neotoma</a> is a truth layer for persistent agent memory: an explicit, inspectable substrate for personal data that AI tools read and write via Model Context Protocol (MCP).</p><p class="text-[15px] leading-7 mb-4">You control what goes in; entities, timelines, and provenance stay deterministic and queryable.</p><p class="text-[15px] leading-7 mb-4">Install with npm, then configure MCP for Cursor, Claude Code, or Codex. Use CLI commands as fallback when MCP is unavailable.</p><figure class="my-10 rounded border border-neutral-200 overflow-hidden"><img src="https://markmhendrickson.com/images/posts/truth-layer-agent-memory-hero.png" alt="Neotoma: truth layer for persistent agent memory" loading="eager" class="block max-w-full h-auto"/></figure><h2 id="install" class="group scroll-mt-6 text-[20px] font-medium tracking-[-0.02em] mt-14 mb-3">Install with npm<a href="#install" class="ml-2 inline-flex items-center text-neutral-500 no-underline border-none opacity-40 group-hover:opacity-70 hover:!opacity-100 hover:text-neutral-800 transition" aria-label="Link to section">#</a></h2><div class="relative mb-4"><pre class="mb-4 bg-neutral-100 rounded p-4 overflow-x-auto"><code class="font-mono text-[14px]"># Global install
npm install -g neotoma

# Initialize Neotoma (creates directories, database, config)
neotoma init

# Or with encryption enabled (privacy-first mode)
neotoma init --generate-keys</code></pre></div><p class="text-[15px] leading-7 mb-4">After initialization:</p><div class="relative mb-4"><pre class="mb-4 bg-neutral-100 rounded p-4 overflow-x-auto"><code class="font-mono text-[14px]"># Start the API server
neotoma api start --env dev

# Configure MCP for your AI tool
neotoma mcp config

# Check status
neotoma api status</code></pre></div><div class="flex items-center gap-3 my-12" aria-hidden="true"><span class="h-px flex-1 bg-neutral-200"></span><span class="text-[8px] text-neutral-400 leading-none">◆</span><span class="h-px flex-1 bg-neutral-200"></span></div><h2 id="configure-mcp" class="group scroll-mt-6 text-[20px] font-medium tracking-[-0.02em] mt-14 mb-3">Configure MCP for Cursor, Claude Code, and Codex<a href="#configure-mcp" class="ml-2 inline-flex items-center text-neutral-500 no-underline border-none opacity-40 group-hover:opacity-70 hover:!opacity-100 hover:text-neutral-800 transition" aria-label="Link to section">#</a></h2><p class="text-[15px] leading-7 mb-4"><strong>Transport:</strong> use <code>stdio</code> for local usage on the same machine as the Neotoma repo, and HTTP for remote or tunnel access.</p><p class="text-[15px] leading-7 mb-4">Canonical MCP config lives in <code>.cursor/mcp.json</code> and can be synced to other tools.</p><div class="relative mb-4"><pre class="mb-4 bg-neutral-100 rounded p-4 overflow-x-auto"><code class="font-mono text-[14px]">{
  &quot;mcpServers&quot;: {
    &quot;neotoma-dev&quot;: {
      &quot;command&quot;: &quot;/absolute/path/to/neotoma/scripts/run_neotoma_mcp_stdio.sh&quot;
    },
    &quot;neotoma&quot;: {
      &quot;command&quot;: &quot;/absolute/path/to/neotoma/scripts/run_neotoma_mcp_stdio_prod.sh&quot;
    }
  }
}</code></pre></div><h3 class="text-[18px] font-medium tracking-[-0.02em] mt-8 mb-2">Set up Cursor</h3><ul class="list-disc pl-5 mb-4"><li class="text-[15px] leading-7 mt-3 first:mt-0">Build server first: <code>npm run build:server</code></li><li class="text-[15px] leading-7 mt-3 first:mt-0">Use stdio config in <code>.cursor/mcp.json</code></li><li class="text-[15px] leading-7 mt-3 first:mt-0">Restart Cursor after config changes</li></ul><h3 class="text-[18px] font-medium tracking-[-0.02em] mt-8 mb-2">Sync Claude Code and Codex from Cursor config</h3><div class="relative mb-4"><pre class="mb-4 bg-neutral-100 rounded p-4 overflow-x-auto"><code class="font-mono text-[14px]">cd /path/to/neotoma
# Add neotoma-dev and neotoma to .cursor/mcp.json (see mcp_cursor_setup.md Option A)
npm run sync:mcp</code></pre></div><ul class="list-disc pl-5 mb-4"><li class="text-[15px] leading-7 mt-3 first:mt-0"><code>npm run sync:mcp</code> propagates servers to <code>.mcp.json</code> and <code>.codex/config.toml</code></li><li class="text-[15px] leading-7 mt-3 first:mt-0">Restart Claude Code or Codex after config updates</li></ul><div class="flex items-center gap-3 my-12" aria-hidden="true"><span class="h-px flex-1 bg-neutral-200"></span><span class="text-[8px] text-neutral-400 leading-none">◆</span><span class="h-px flex-1 bg-neutral-200"></span></div><h2 id="cli" class="group scroll-mt-6 text-[20px] font-medium tracking-[-0.02em] mt-14 mb-3">Use the CLI when MCP is unavailable<a href="#cli" class="ml-2 inline-flex items-center text-neutral-500 no-underline border-none opacity-40 group-hover:opacity-70 hover:!opacity-100 hover:text-neutral-800 transition" aria-label="Link to section">#</a></h2><p class="text-[15px] leading-7 mb-4">Run these commands directly when MCP is not available:</p><div class="relative mb-4"><pre class="mb-4 bg-neutral-100 rounded p-4 overflow-x-auto"><code class="font-mono text-[14px]">neotoma entities list --type company --limit 10</code></pre></div><div class="relative mb-4"><pre class="mb-4 bg-neutral-100 rounded p-4 overflow-x-auto"><code class="font-mono text-[14px]">neotoma store --json=&#x27;[{&quot;entity_type&quot;:&quot;task&quot;,&quot;title&quot;:&quot;Submit expense report&quot;,&quot;status&quot;:&quot;open&quot;}]&#x27;</code></pre></div><div class="relative mb-4"><pre class="mb-4 bg-neutral-100 rounded p-4 overflow-x-auto"><code class="font-mono text-[14px]">neotoma upload ./fixtures/invoice.pdf
neotoma upload ./doc.pdf --no-interpret --mime-type application/pdf
neotoma upload --local ./invoice.pdf   # run in-process, no API server required</code></pre></div><div class="flex items-center gap-3 my-12" aria-hidden="true"><span class="h-px flex-1 bg-neutral-200"></span><span class="text-[8px] text-neutral-400 leading-none">◆</span><span class="h-px flex-1 bg-neutral-200"></span></div><h2 id="bugs" class="group scroll-mt-6 text-[20px] font-medium tracking-[-0.02em] mt-14 mb-3">Report or fix bugs when detected<a href="#bugs" class="ml-2 inline-flex items-center text-neutral-500 no-underline border-none opacity-40 group-hover:opacity-70 hover:!opacity-100 hover:text-neutral-800 transition" aria-label="Link to section">#</a></h2><p class="text-[15px] leading-7 mb-4">Neotoma&#x27;s MCP and CLI agent instructions automatically propose that bugs are reported or fixed when detected. If the agent sees a Neotoma error or you describe a bug, it will suggest either filing an issue on GitHub or, when it has access to a clone or fork of the repo, contributing a fix via a fork and pull request.</p><div class="flex items-center gap-3 my-12" aria-hidden="true"><span class="h-px flex-1 bg-neutral-200"></span><span class="text-[8px] text-neutral-400 leading-none">◆</span><span class="h-px flex-1 bg-neutral-200"></span></div><h2 id="terminology" class="group scroll-mt-6 text-[20px] font-medium tracking-[-0.02em] mt-14 mb-3">Core terminology<a href="#terminology" class="ml-2 inline-flex items-center text-neutral-500 no-underline border-none opacity-40 group-hover:opacity-70 hover:!opacity-100 hover:text-neutral-800 transition" aria-label="Link to section">#</a></h2><div class="relative mb-4"><div class="max-w-full overflow-x-auto"><table class="w-full border border-neutral-200 border-collapse text-[15px] leading-7"><thead><tr><th class="text-left p-3 border-r border-b border-neutral-200 bg-neutral-50 min-w-[14ch]">Term</th><th class="text-left p-3 border-b border-neutral-200 bg-neutral-50 min-w-[36ch]">Definition</th></tr></thead><tbody><tr><td class="align-top p-3 border-r border-b border-neutral-200 font-medium">Truth Layer</td><td class="align-top p-3 border-b border-neutral-200">Neotoma&#x27;s role: a deterministic, immutable structured memory substrate that other layers read and write.</td></tr><tr><td class="align-top p-3 border-r border-b border-neutral-200 font-medium">Entity</td><td class="align-top p-3 border-b border-neutral-200">Canonical representation of a person, company, or other object with a deterministic ID.</td></tr><tr><td class="align-top p-3 border-r border-b border-neutral-200 font-medium">Entity snapshot</td><td class="align-top p-3 border-b border-neutral-200">Current truth for an entity; computed by merging all observations about that entity.</td></tr><tr><td class="align-top p-3 border-r border-b border-neutral-200 font-medium">Observation</td><td class="align-top p-3 border-b border-neutral-200">Granular fact extracted from source; reducers merge observations into entity snapshots.</td></tr><tr><td class="align-top p-3 border-r border-b border-neutral-200 font-medium">Source</td><td class="align-top p-3 border-b border-neutral-200">Raw data (file, text, URL, or structured JSON) stored with content-addressed deduplication.</td></tr><tr><td class="align-top p-3 border-r border-b border-neutral-200 font-medium">Provenance</td><td class="align-top p-3 border-b border-neutral-200">Origin tracking (source, timestamp, user, interpretation) so every value traces back to its source.</td></tr><tr><td class="align-top p-3 border-r border-b border-neutral-200 font-medium">Memory graph</td><td class="align-top p-3 border-b border-neutral-200">The graph of source, observations, entities, relationships, and events with typed edges.</td></tr><tr><td class="align-top p-3 border-r border-b border-neutral-200 font-medium">Reducer</td><td class="align-top p-3 border-b border-neutral-200">Deterministic function that merges observations into an entity snapshot; same observations always yield the same snapshot.</td></tr><tr><td class="align-top p-3 border-r border-b border-neutral-200 font-medium">Relationship</td><td class="align-top p-3 border-b border-neutral-200">Typed connection between two entities (e.g. SETTLES, REFERS_TO, PART_OF).</td></tr><tr><td class="align-top p-3 border-r border-b border-neutral-200 font-medium">Entity type</td><td class="align-top p-3 border-b border-neutral-200">Classification (e.g. person, company, invoice) that determines the entity schema and resolution rules.</td></tr><tr><td class="align-top p-3 border-r border-b border-neutral-200 font-medium">Storing</td><td class="align-top p-3 border-b border-neutral-200">Uploading and processing source into the memory graph (unstructured or structured).</td></tr><tr><td class="align-top p-3 border-r border-b border-neutral-200 font-medium">Retrieving</td><td class="align-top p-3 border-b border-neutral-200">Querying entities, entity snapshots, observations, and related data from the memory graph.</td></tr></tbody></table></div></div><div class="flex items-center gap-3 my-12" aria-hidden="true"><span class="h-px flex-1 bg-neutral-200"></span><span class="text-[8px] text-neutral-400 leading-none">◆</span><span class="h-px flex-1 bg-neutral-200"></span></div><h2 id="functionality" class="group scroll-mt-6 text-[20px] font-medium tracking-[-0.02em] mt-14 mb-3">Functionality by OpenAPI resource<a href="#functionality" class="ml-2 inline-flex items-center text-neutral-500 no-underline border-none opacity-40 group-hover:opacity-70 hover:!opacity-100 hover:text-neutral-800 transition" aria-label="Link to section">#</a></h2><p class="text-[15px] leading-7 mb-4">Neotoma capabilities by area: OpenAPI endpoint(s) (<a href="https://github.com/markmhendrickson/neotoma/blob/main/openapi.yaml">spec</a>), CLI command(s), MCP action(s), and test coverage.</p><div class="relative mb-4"><div class="max-w-full overflow-x-auto"><table class="w-full border border-neutral-200 border-collapse text-[15px] leading-7"><thead><tr><th class="text-left font-medium p-3 border-r border-b border-neutral-200 bg-neutral-50 min-w-[20ch]">Functionality</th><th class="text-left font-medium p-3 border-r border-b border-neutral-200 bg-neutral-50 min-w-[28ch]">OpenAPI endpoint(s)</th><th class="text-left font-medium p-3 border-r border-b border-neutral-200 bg-neutral-50 min-w-[24ch]">CLI command(s)</th><th class="text-left font-medium p-3 border-r border-b border-neutral-200 bg-neutral-50 min-w-[22ch]">MCP action(s)</th><th class="text-left font-medium p-3 border-b border-neutral-200 bg-neutral-50 min-w-[24ch]">Test coverage</th></tr></thead><tbody><tr><td class="align-top p-3 border-r border-b border-neutral-200 font-medium">Auth / current user</td><td class="align-top p-3 border-r border-b border-neutral-200"><code class="text-[13px] break-words whitespace-normal">GET /api/me, POST /api/mcp/oauth/initiate, GET /api/mcp/oauth/authorize, POST /api/mcp/oauth/token, GET /api/mcp/oauth/status, GET /api/mcp/oauth/connections, DELETE /api/mcp/oauth/connections/{id}</code></td><td class="align-top p-3 border-r border-b border-neutral-200"><code class="text-[13px] break-words whitespace-normal">auth login, auth status, auth whoami, request (OAuth ops)</code></td><td class="align-top p-3 border-r border-b border-neutral-200"><code class="text-[13px] break-words whitespace-normal">get_authenticated_user</code></td><td class="align-top p-3 border-b border-neutral-200 break-words">cli_auth_commands, mcp_oauth_flow, mcp_oauth (service)</td></tr><tr><td class="align-top p-3 border-r border-b border-neutral-200 font-medium">Query entities (list with filters)</td><td class="align-top p-3 border-r border-b border-neutral-200"><code class="text-[13px] break-words whitespace-normal">POST /api/entities/query</code></td><td class="align-top p-3 border-r border-b border-neutral-200"><code class="text-[13px] break-words whitespace-normal">entities list</code></td><td class="align-top p-3 border-r border-b border-neutral-200"><code class="text-[13px] break-words whitespace-normal">retrieve_entities</code></td><td class="align-top p-3 border-b border-neutral-200 break-words">cli_entity_subcommands, cli_to_mcp_entities, mcp_entity_variations, mcp_query_variations, entity_queries</td></tr><tr><td class="align-top p-3 border-r border-b border-neutral-200 font-medium">Get entity by ID</td><td class="align-top p-3 border-r border-b border-neutral-200"><code class="text-[13px] break-words whitespace-normal">GET /api/entities/{id}</code></td><td class="align-top p-3 border-r border-b border-neutral-200"><code class="text-[13px] break-words whitespace-normal">entities get</code></td><td class="align-top p-3 border-r border-b border-neutral-200"><code class="text-[13px] break-words whitespace-normal">—</code></td><td class="align-top p-3 border-b border-neutral-200 break-words">cli_entity_subcommands, cli_to_mcp_entities</td></tr><tr><td class="align-top p-3 border-r border-b border-neutral-200 font-medium">Entity snapshot with provenance</td><td class="align-top p-3 border-r border-b border-neutral-200"><code class="text-[13px] break-words whitespace-normal">POST /get_entity_snapshot</code></td><td class="align-top p-3 border-r border-b border-neutral-200"><code class="text-[13px] break-words whitespace-normal">request --operation getEntitySnapshot</code></td><td class="align-top p-3 border-r border-b border-neutral-200"><code class="text-[13px] break-words whitespace-normal">retrieve_entity_snapshot</code></td><td class="align-top p-3 border-b border-neutral-200 break-words">cli_to_mcp_entities, mcp_resource_variations, cli_to_mcp_stats_snapshots</td></tr><tr><td class="align-top p-3 border-r border-b border-neutral-200 font-medium">Entity observations and field provenance</td><td class="align-top p-3 border-r border-b border-neutral-200"><code class="text-[13px] break-words whitespace-normal">GET /api/entities/{id}/observations, POST /list_observations, POST /get_field_provenance</code></td><td class="align-top p-3 border-r border-b border-neutral-200"><code class="text-[13px] break-words whitespace-normal">request (getEntityObservations, listObservationsForEntity, getFieldProvenance)</code></td><td class="align-top p-3 border-r border-b border-neutral-200"><code class="text-[13px] break-words whitespace-normal">list_observations, retrieve_field_provenance</code></td><td class="align-top p-3 border-b border-neutral-200 break-words">cli_observation_commands, mcp_resource_variations</td></tr><tr><td class="align-top p-3 border-r border-b border-neutral-200 font-medium">Entity relationships (list for entity)</td><td class="align-top p-3 border-r border-b border-neutral-200"><code class="text-[13px] break-words whitespace-normal">GET /api/entities/{id}/relationships, POST /list_relationships</code></td><td class="align-top p-3 border-r border-b border-neutral-200"><code class="text-[13px] break-words whitespace-normal">relationships list</code></td><td class="align-top p-3 border-r border-b border-neutral-200"><code class="text-[13px] break-words whitespace-normal">list_relationships</code></td><td class="align-top p-3 border-b border-neutral-200 break-words">cli_relationship_commands, cli_to_mcp_relationships, mcp_relationship_variations</td></tr><tr><td class="align-top p-3 border-r border-b border-neutral-200 font-medium">Search entity by identifier / semantic</td><td class="align-top p-3 border-r border-b border-neutral-200"><code class="text-[13px] break-words whitespace-normal">POST /retrieve_entity_by_identifier</code></td><td class="align-top p-3 border-r border-b border-neutral-200"><code class="text-[13px] break-words whitespace-normal">entities search</code></td><td class="align-top p-3 border-r border-b border-neutral-200"><code class="text-[13px] break-words whitespace-normal">retrieve_entity_by_identifier</code></td><td class="align-top p-3 border-b border-neutral-200 break-words">cli_query_commands, mcp_entity_variations</td></tr><tr><td class="align-top p-3 border-r border-b border-neutral-200 font-medium">Related entities and graph neighborhood</td><td class="align-top p-3 border-r border-b border-neutral-200"><code class="text-[13px] break-words whitespace-normal">POST /retrieve_related_entities, POST /retrieve_graph_neighborhood</code></td><td class="align-top p-3 border-r border-b border-neutral-200"><code class="text-[13px] break-words whitespace-normal">entities related, entities neighborhood</code></td><td class="align-top p-3 border-r border-b border-neutral-200"><code class="text-[13px] break-words whitespace-normal">retrieve_related_entities, retrieve_graph_neighborhood</code></td><td class="align-top p-3 border-b border-neutral-200 break-words">cli_query_commands, mcp_graph_variations</td></tr><tr><td class="align-top p-3 border-r border-b border-neutral-200 font-medium">Merge entities</td><td class="align-top p-3 border-r border-b border-neutral-200"><code class="text-[13px] break-words whitespace-normal">POST /api/entities/merge</code></td><td class="align-top p-3 border-r border-b border-neutral-200"><code class="text-[13px] break-words whitespace-normal">request --operation mergeEntities</code></td><td class="align-top p-3 border-r border-b border-neutral-200"><code class="text-[13px] break-words whitespace-normal">merge_entities</code></td><td class="align-top p-3 border-b border-neutral-200 break-words">cli_entity_subcommands, mcp_entity_variations</td></tr><tr><td class="align-top p-3 border-r border-b border-neutral-200 font-medium">Delete / restore entity</td><td class="align-top p-3 border-r border-b border-neutral-200"><code class="text-[13px] break-words whitespace-normal">POST /delete_entity, POST /restore_entity</code></td><td class="align-top p-3 border-r border-b border-neutral-200"><code class="text-[13px] break-words whitespace-normal">entities delete, entities restore</code></td><td class="align-top p-3 border-r border-b border-neutral-200"><code class="text-[13px] break-words whitespace-normal">delete_entity, restore_entity</code></td><td class="align-top p-3 border-b border-neutral-200 break-words">cli_entity_subcommands, deletion (service), mcp_correction_variations</td></tr><tr><td class="align-top p-3 border-r border-b border-neutral-200 font-medium">Sources (list, get)</td><td class="align-top p-3 border-r border-b border-neutral-200"><code class="text-[13px] break-words whitespace-normal">GET /api/sources, GET /api/sources/{id}</code></td><td class="align-top p-3 border-r border-b border-neutral-200"><code class="text-[13px] break-words whitespace-normal">sources list, request --operation getSourceById</code></td><td class="align-top p-3 border-r border-b border-neutral-200"><code class="text-[13px] break-words whitespace-normal">—</code></td><td class="align-top p-3 border-b border-neutral-200 break-words">cli_source_commands, mcp_resources</td></tr><tr><td class="align-top p-3 border-r border-b border-neutral-200 font-medium">Observations (list, query, create)</td><td class="align-top p-3 border-r border-b border-neutral-200"><code class="text-[13px] break-words whitespace-normal">GET /api/observations, POST /api/observations/query, POST /api/observations/create</code></td><td class="align-top p-3 border-r border-b border-neutral-200"><code class="text-[13px] break-words whitespace-normal">request (listObservations), observations list</code></td><td class="align-top p-3 border-r border-b border-neutral-200"><code class="text-[13px] break-words whitespace-normal">—</code></td><td class="align-top p-3 border-b border-neutral-200 break-words">cli_observation_commands, observation_ingestion</td></tr><tr><td class="align-top p-3 border-r border-b border-neutral-200 font-medium">Relationships (list, get, snapshot)</td><td class="align-top p-3 border-r border-b border-neutral-200"><code class="text-[13px] break-words whitespace-normal">GET /api/relationships, GET /api/relationships/{id}, POST /api/relationships/snapshot</code></td><td class="align-top p-3 border-r border-b border-neutral-200"><code class="text-[13px] break-words whitespace-normal">relationships list, request (getRelationshipById), relationships get-snapshot</code></td><td class="align-top p-3 border-r border-b border-neutral-200"><code class="text-[13px] break-words whitespace-normal">get_relationship_snapshot</code></td><td class="align-top p-3 border-b border-neutral-200 break-words">cli_relationship_commands, cli_to_mcp_relationships, mcp_relationship_variations, relationship_snapshots</td></tr><tr><td class="align-top p-3 border-r border-b border-neutral-200 font-medium">Create / delete / restore relationship</td><td class="align-top p-3 border-r border-b border-neutral-200"><code class="text-[13px] break-words whitespace-normal">POST /create_relationship, POST /delete_relationship, POST /restore_relationship</code></td><td class="align-top p-3 border-r border-b border-neutral-200"><code class="text-[13px] break-words whitespace-normal">request (createRelationship), relationships delete, relationships restore</code></td><td class="align-top p-3 border-r border-b border-neutral-200"><code class="text-[13px] break-words whitespace-normal">create_relationship, delete_relationship, restore_relationship</code></td><td class="align-top p-3 border-b border-neutral-200 break-words">cli_relationship_commands, cli_correction_commands, mcp_relationship_variations, deletion (service)</td></tr><tr><td class="align-top p-3 border-r border-b border-neutral-200 font-medium">Timeline events</td><td class="align-top p-3 border-r border-b border-neutral-200"><code class="text-[13px] break-words whitespace-normal">GET /api/timeline, GET /api/timeline/{id}</code></td><td class="align-top p-3 border-r border-b border-neutral-200"><code class="text-[13px] break-words whitespace-normal">timeline list, timeline get</code></td><td class="align-top p-3 border-r border-b border-neutral-200"><code class="text-[13px] break-words whitespace-normal">list_timeline_events</code></td><td class="align-top p-3 border-b border-neutral-200 break-words">cli_timeline_commands, cli_to_mcp_stats_snapshots, event_generation</td></tr><tr><td class="align-top p-3 border-r border-b border-neutral-200 font-medium">Schemas (list types, get schema)</td><td class="align-top p-3 border-r border-b border-neutral-200"><code class="text-[13px] break-words whitespace-normal">GET /api/schemas, GET /api/schemas/{entity_type}</code></td><td class="align-top p-3 border-r border-b border-neutral-200"><code class="text-[13px] break-words whitespace-normal">schemas list, schemas get</code></td><td class="align-top p-3 border-r border-b border-neutral-200"><code class="text-[13px] break-words whitespace-normal">list_entity_types</code></td><td class="align-top p-3 border-b border-neutral-200 break-words">cli_to_mcp_schemas, cli_schema_commands, mcp_schema_variations</td></tr><tr><td class="align-top p-3 border-r border-b border-neutral-200 font-medium">Schema analysis and incremental update</td><td class="align-top p-3 border-r border-b border-neutral-200"><code class="text-[13px] break-words whitespace-normal">POST /analyze_schema_candidates, POST /get_schema_recommendations, POST /update_schema_incremental, POST /register_schema</code></td><td class="align-top p-3 border-r border-b border-neutral-200"><code class="text-[13px] break-words whitespace-normal">schemas analyze-candidates, schemas recommendations, schemas update-incremental, schemas register</code></td><td class="align-top p-3 border-r border-b border-neutral-200"><code class="text-[13px] break-words whitespace-normal">analyze_schema_candidates, get_schema_recommendations, update_schema_incremental, register_schema</code></td><td class="align-top p-3 border-b border-neutral-200 break-words">cli_schema_commands, mcp_schema_actions, mcp_schema_variations, schema_recommendation (service), schema_recommendation_integration</td></tr><tr><td class="align-top p-3 border-r border-b border-neutral-200 font-medium">Store (structured entities)</td><td class="align-top p-3 border-r border-b border-neutral-200"><code class="text-[13px] break-words whitespace-normal">POST /api/store</code></td><td class="align-top p-3 border-r border-b border-neutral-200"><code class="text-[13px] break-words whitespace-normal">store</code></td><td class="align-top p-3 border-r border-b border-neutral-200"><code class="text-[13px] break-words whitespace-normal">store, store_structured</code></td><td class="align-top p-3 border-b border-neutral-200 break-words">cli_store_commands, cli_to_mcp_store, mcp_store_variations, fixture_mcp_store_replay</td></tr><tr><td class="align-top p-3 border-r border-b border-neutral-200 font-medium">Store (unstructured files)</td><td class="align-top p-3 border-r border-b border-neutral-200"><code class="text-[13px] break-words whitespace-normal">POST /api/store/unstructured</code></td><td class="align-top p-3 border-r border-b border-neutral-200"><code class="text-[13px] break-words whitespace-normal">upload &lt;path&gt;</code></td><td class="align-top p-3 border-r border-b border-neutral-200"><code class="text-[13px] break-words whitespace-normal">store_unstructured</code></td><td class="align-top p-3 border-b border-neutral-200 break-words">cli_store_commands, mcp_store_unstructured, mcp_store_parquet, nonjson_csv_store_behavior</td></tr><tr><td class="align-top p-3 border-r border-b border-neutral-200 font-medium">Correct and reinterpret</td><td class="align-top p-3 border-r border-b border-neutral-200"><code class="text-[13px] break-words whitespace-normal">POST /correct, POST /reinterpret</code></td><td class="align-top p-3 border-r border-b border-neutral-200"><code class="text-[13px] break-words whitespace-normal">corrections create, interpretations reinterpret</code></td><td class="align-top p-3 border-r border-b border-neutral-200"><code class="text-[13px] break-words whitespace-normal">correct, reinterpret</code></td><td class="align-top p-3 border-b border-neutral-200 break-words">cli_correction_commands, mcp_correction_variations, interpretation (service)</td></tr><tr><td class="align-top p-3 border-r border-b border-neutral-200 font-medium">Interpretations (list)</td><td class="align-top p-3 border-r border-b border-neutral-200"><code class="text-[13px] break-words whitespace-normal">GET /api/interpretations</code></td><td class="align-top p-3 border-r border-b border-neutral-200"><code class="text-[13px] break-words whitespace-normal">request --operation listInterpretations</code></td><td class="align-top p-3 border-r border-b border-neutral-200"><code class="text-[13px] break-words whitespace-normal">—</code></td><td class="align-top p-3 border-b border-neutral-200 break-words">cli_observation_commands, interpretation (service)</td></tr><tr><td class="align-top p-3 border-r border-b border-neutral-200 font-medium">Stats and health</td><td class="align-top p-3 border-r border-b border-neutral-200"><code class="text-[13px] break-words whitespace-normal">GET /api/stats, GET /api/server-info, POST /health_check_snapshots</code></td><td class="align-top p-3 border-r border-b border-neutral-200"><code class="text-[13px] break-words whitespace-normal">stats, snapshots check</code></td><td class="align-top p-3 border-r border-b border-neutral-200"><code class="text-[13px] break-words whitespace-normal">health_check_snapshots</code></td><td class="align-top p-3 border-b border-neutral-200 break-words">cli_stats_commands, cli_to_mcp_stats_snapshots, dashboard_stats</td></tr><tr><td class="align-top p-3 border-r border-b border-neutral-200 font-medium">File URL (signed access)</td><td class="align-top p-3 border-r border-b border-neutral-200"><code class="text-[13px] break-words whitespace-normal">GET /get_file_url (internal path)</code></td><td class="align-top p-3 border-r border-b border-neutral-200"><code class="text-[13px] break-words whitespace-normal">request --operation getFileUrl</code></td><td class="align-top p-3 border-r border-b border-neutral-200"><code class="text-[13px] break-words whitespace-normal">retrieve_file_url</code></td><td class="align-top p-3 border-b border-neutral-200 break-words">mcp_resources, contract_mapping</td></tr></tbody></table></div></div><div class="flex items-center gap-3 my-12" aria-hidden="true"><span class="h-px flex-1 bg-neutral-200"></span><span class="text-[8px] text-neutral-400 leading-none">◆</span><span class="h-px flex-1 bg-neutral-200"></span></div><h2 id="agent-instructions" class="group scroll-mt-6 text-[20px] font-medium tracking-[-0.02em] mt-14 mb-3">Agent instructions<a href="#agent-instructions" class="ml-2 inline-flex items-center text-neutral-500 no-underline border-none opacity-40 group-hover:opacity-70 hover:!opacity-100 hover:text-neutral-800 transition" aria-label="Link to section">#</a></h2><p class="text-[15px] leading-7 mb-4">Agents use Neotoma via MCP when it is installed and running, or via the CLI when MCP is not available. The same behaviors apply either way. The instructions below summarize how agents are told to use Neotoma.</p><ul class="list-disc pl-5 mb-4"><li class="text-[15px] leading-7 mt-3 first:mt-0"><strong>Chat persistence:</strong> Every turn, the agent stores the conversation and current user message (plus implied entities) before responding.</li><li class="text-[15px] leading-7 mt-3 first:mt-0"><strong>Proactive retrieval:</strong> After persistence, the agent runs bounded retrieval when the prompt may depend on stored memory.</li><li class="text-[15px] leading-7 mt-3 first:mt-0"><strong>Attachments:</strong> Attachments are stored in the same request, linked via EMBEDS, and visible entities are extracted and linked with REFERS_TO.</li><li class="text-[15px] leading-7 mt-3 first:mt-0"><strong>Entity extraction:</strong> Shared facts become stored entities with descriptive types and fields from the message.</li><li class="text-[15px] leading-7 mt-3 first:mt-0"><strong>Tasks:</strong> Intent or future-action statements generate tasks with due dates when present.</li><li class="text-[15px] leading-7 mt-3 first:mt-0"><strong>External data:</strong> Data pulled from other tools is stored in Neotoma before the agent responds.</li></ul><div class="flex items-center gap-3 my-12" aria-hidden="true"><span class="h-px flex-1 bg-neutral-200"></span><span class="text-[8px] text-neutral-400 leading-none">◆</span><span class="h-px flex-1 bg-neutral-200"></span></div><h2 id="learn-more" class="group scroll-mt-6 text-[20px] font-medium tracking-[-0.02em] mt-14 mb-3">Learn more<a href="#learn-more" class="ml-2 inline-flex items-center text-neutral-500 no-underline border-none opacity-40 group-hover:opacity-70 hover:!opacity-100 hover:text-neutral-800 transition" aria-label="Link to section">#</a></h2><ul class="list-disc pl-5 mb-4"><li class="text-[15px] leading-7 mt-3 first:mt-0"><a href="https://github.com/markmhendrickson/neotoma?tab=readme-ov-file#neotoma-truth-layer-for-persistent-agent-memory">View repository</a> (GitHub README and rationale)</li><li class="text-[15px] leading-7 mt-3 first:mt-0"><a href="https://markmhendrickson.com/posts/truth-layer-agent-memory">Building a truth layer for persistent agent memory</a></li><li class="text-[15px] leading-7 mt-3 first:mt-0"><a href="https://markmhendrickson.com/posts/agent-command-centers-source-of-truth">Agent command centers need one source of truth</a></li></ul></article></div></main></div>
  </body>
</html>