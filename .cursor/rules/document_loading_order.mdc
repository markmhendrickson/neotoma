---
# ⚠️  DO NOT EDIT THIS FILE DIRECTLY
#
# This is a copy of: foundation/agent_instructions/cursor_rules/document_loading_order.mdc
# Source of truth: foundation/agent_instructions/cursor_rules/document_loading_order.mdc
#
# To edit this rule:
# 1. Edit the source file in foundation: foundation/agent_instructions/cursor_rules/document_loading_order.mdc
# 2. Run '/setup_cursor_copies' to sync changes
#
# This file will be overwritten when running setup_cursor_copies.
---

---
description: "Ensures agents load documentation in the correct order to establish proper context before proceeding with work"
alwaysApply: true
---
# Document Loading Order Rule

**Reference:** `foundation/conventions/documentation-standards.md` - Documentation standards

## Purpose

Ensures agents load documentation in the correct order to establish proper context before proceeding with work.

## Scope

This document defines:
- Mandatory loading order for documentation
- Foundation submodule usage
- Workflows for AI assistants and human developers

This document does NOT cover:
- Specific constraints agents must enforce (see `agent_constraints.md`)
- Risk management and hold points (see `risk_management.md`)
- Repository-specific document paths (configured in `foundation-config.yaml`)

## Configuration

Configure document loading paths in `foundation-config.yaml`:

```yaml
agent_instructions:
  enabled: true
  location: "docs/foundation/agent_instructions.md"  # Repository-wide agent instructions
  foundation_docs_path: "docs/foundation/"  # Path to foundation documents
  cursor_rules:
    enabled: true
    location: ".cursor/rules/"
```

**Document paths are configurable per repository.** Default paths shown above can be customized in `foundation-config.yaml`.

## Mandatory Loading Order

Every AI assistant session MUST load documents in this order:

### 1. Foundation Documents (First)

Load foundation documents from configured foundation docs path FIRST (default: `docs/foundation/`):

**Required foundation documents:**
- Core philosophy/principles document (e.g., `philosophy.md`, `principles.md`)
- Core identity document (e.g., `core_identity.md`, `identity.md`)
- Data models document (if applicable, e.g., `data_models.md`)
- Architecture document (if applicable, e.g., `architecture.md`, `layered_architecture.md`)

**Why:** These establish the fundamental constraints and boundaries that all other work must respect.

**Configuration:** Set `agent_instructions.foundation_docs_path` in `foundation-config.yaml` to customize the path.

### 2. Foundation Submodule Documents (When Needed)

Load shared foundation processes from `foundation/` submodule when needed:

- `foundation/development/workflow.md` - For git workflow, branching, PRs
- `foundation/conventions/code-conventions.md` - For code style and naming
- `foundation/conventions/documentation-standards.md` - For documentation structure
- `foundation/security/security-rules.md` - For security practices
- `foundation-config.yaml` - For repository-specific configuration

**When:** Load when working on development workflow, code style, documentation, or security-related tasks.

### 3. Task-Specific Documents

Load task-specific docs based on change type:

- **Architecture changes:** Architecture docs from configured architecture path (default: `docs/architecture/`)
- **Subsystem work:** Relevant subsystem docs from configured subsystems path (default: `docs/subsystems/`)
- **Feature work:** Feature specs from configured specs path (default: `docs/specs/` or `docs/feature_units/`)
- **Release work:** Release plans and status from configured releases path (default: `docs/releases/`)
- **Documentation work:** Documentation standards from configured conventions path (default: `docs/conventions/`)
- **Code work:** Code conventions from configured conventions path (default: `docs/conventions/`)

**Configuration:** Document paths can be customized per repository structure.

### 4. Related Context Documents

Load additional context as needed:

- Related subsystem docs
- Integration guides
- Testing standards
- API specifications

## For AI Assistants

**Every session:**

1. Load foundation documents from configured foundation docs path first (see Section 1)
2. Load foundation submodule docs when relevant (see Section 2)
3. Reference foundation documents to resolve ambiguities
4. Validate all outputs against invariants
5. Stop at hold points for human approval (see `.cursor/rules/foundation-risk_management.md` if exists)

**When uncertain:**

- Default to conservative interpretation
- Prioritize correctness over convenience
- Ask for clarification rather than guess

## For Human Developers

**Before starting work:**

1. Read foundation documents from configured foundation docs path (see Section 1)
2. Read relevant subsystem/docs as indicated by context
3. Understand project constraints and boundaries
4. Verify feature fits within project scope

**During implementation:**

- Follow project conventions
- Write maintainable code
- Test thoroughly
- Document all assumptions

**Before committing:**

- **Run security audit** from `foundation/security/pre-commit-audit.sh` (if configured)
- Verify alignment with project standards
- Check validation checklists
- Run full test suite
- Update docs if patterns changed
- **Follow commit format** from `foundation/development/workflow.md` (configured in `foundation-config.yaml`)

## Using Foundation Submodule

Repositories using the foundation framework have access to the shared **foundation** submodule (`foundation/`) for development processes and conventions:

### When to Reference Foundation

**Development Workflow:**
- Creating branches: See `foundation/development/workflow.md` and `foundation/development/branch-strategy.md`
- Creating worktrees: Use `foundation/development/worktree-setup.sh` (if configured)
- PR process: Follow `foundation/development/pr-process.md`
- Commit format: Configured in `foundation-config.yaml` (see `development.commit_format.pattern`)

**Code Conventions:**
- Code style: See `foundation/conventions/code-conventions.md`
- Naming patterns: See `foundation/conventions/naming-patterns.yaml`
- Repository overrides: Check `foundation-config.yaml` for repo-specific settings

**Documentation:**
- Doc structure: Follow `foundation/conventions/documentation-standards.md`
- Writing style: Avoid AI-generated patterns, use RFC 2119 language
- Agent Instructions: Use template from `foundation/agent_instructions/README.md`

**Security:**
- Pre-commit audit: Run `foundation/security/pre-commit-audit.sh` before commits (if configured)
- Credential management: See `foundation/security/credential-management.md`
- Security rules: See `foundation/security/security-rules.md`

**Configuration:**
- Repository config: `foundation-config.yaml` (repo root)
- Foundation defaults: `foundation/config/foundation-config.yaml`

### Foundation Submodule vs Repository Foundation Docs

- **`foundation/` submodule**: Shared development processes (workflow, conventions, security) - can be used by multiple repos
- **Repository foundation docs** (e.g., `docs/foundation/`): Repository-specific foundation (philosophy, architecture, product positioning) - repository only

Both are important:
- Use `foundation/` for development practices (how to code, commit, review)
- Use repository foundation docs for repository architecture (what to build, why, constraints)

### Syncing Foundation Updates

When foundation submodule is updated:

```bash
# Update to latest foundation
git submodule update --remote foundation

# Or use sync script (if available)
./foundation/scripts/sync-foundation.sh
```

See `foundation/README.md` for complete foundation documentation.

## Related Documents

- `foundation/conventions/documentation-standards.md` - Documentation standards
- `foundation/README.md` - Foundation submodule documentation
- `foundation-config.yaml` - Repository-specific foundation configuration
- `.cursor/rules/foundation-risk_management.md` - Risk management and hold points (if exists)

