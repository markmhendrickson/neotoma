---
description: "Ensures agents always describe manual test cases after completing a release build"
globs: ["**/*"]
alwaysApply: true
---

# ⚠️  DO NOT EDIT THIS FILE DIRECTLY
#
# This is a copy of: foundation/agent_instructions/cursor_rules/post_build_testing.mdc
# Source of truth: foundation/agent_instructions/cursor_rules/post_build_testing.mdc
#
# To edit this rule:
# 1. Edit the source file: foundation/agent_instructions/cursor_rules/post_build_testing.mdc
# 2. Run '/setup_cursor_copies' to sync changes
#
# This file will be overwritten when running setup_cursor_copies.

# Post-Build Testing Rule

Configuration is read from `foundation-config.yaml`.

Ensures agents always describe manual test cases after completing a release build.

## Rule

After completing a release build:

1. **Generate or update release report** with Testing Guidance section containing:

   - All manual test cases from integration tests file (if configured)
   - Each test formatted as user-facing instructions
   - Step-by-step actions (not technical commands)
   - Expected results for each test

2. **Present test cases to user** with:

   - Summary: "After building this release, run the following manual test cases:"
   - List of all test IDs and names
   - Reference to Testing Guidance section in release report for detailed instructions

3. **Include manual validation requirements** (if present in integration tests):
   - Integration steps with external tools
   - Manual verification steps

---

## When This Applies

- After release orchestrator completes all batches
- After manual release build completion
- When generating release reports (always include Testing Guidance section)
- When user asks "what should I test?" after a build

## Agent Actions

### After Release Build Completes

1. **Load configuration:**
   - Read `foundation-config.yaml` for release directory settings
   - Determine integration tests file location (if configured)

2. **Load integration tests (if file exists):**

   - Read `{configured_releases_directory}/in_progress/{RELEASE_ID}/integration_tests.md` (or configured filename)
   - Extract all test definitions (ID, name, goal, steps, expected results)

3. **Generate test case descriptions:**

   - Format each test as user-facing instructions
   - Convert technical steps to user actions
   - Include expected results

4. **Update release report:**

   - Ensure Testing Guidance section exists and is populated
   - Include all tests from integration tests file
   - Format as manual test cases

5. **Present to user:**

   ```
   Release build complete. To validate functionality, run these manual test cases:

   See Testing Guidance section in release_report.md for detailed instructions:
   - IT-001: Test Case Name
   - IT-002: Test Case Name
   ... (list all tests)

   Each test includes step-by-step user actions and expected results.
   ```

---

## Test Case Format

Each test case MUST include:

```markdown
#### {TEST_ID}: {TEST_NAME}

**Goal:** {GOAL}

**Steps to test:**

1. {USER_ACTION_1}
2. {USER_ACTION_2}
   ...

**Expected results:**

- {EXPECTED_RESULT_1}
- {EXPECTED_RESULT_2}
```

**Step conversion rules:**

- "Call API `endpoint`" → "Call API `endpoint` via configured tools"
- "Query database" → "Query using configured query tools"
- "Verify X" → "Verify X matches expected behavior"
- Remove technical implementation details
- Keep user actions clear and actionable

---

## Integration Points

### Release Orchestrator

After all batches complete:

1. Run full integration test suite (if test files exist)
2. Update `status.md` with test results
3. **ALWAYS generate complete release report (REQUIRED)** - This is a mandatory step per `foundation/development/release_workflow.md` Step 1.4
   - Report must exist before transitioning to `in_testing` status
   - Report includes Testing Guidance section with all manual test cases
   - Follow `docs/feature_units/standards/release_report_generation.md` for structure
4. Log: "See release_report.md Testing Guidance section for manual test cases"

### Release Report Generation

Testing Guidance section is REQUIRED and must include:
- All tests from integration tests file
- Format as user-facing manual test cases
- Include manual validation requirements

### Manual Build Completion

If release is built manually (not via orchestrator):
- Still generate/update release report with Testing Guidance section
- Present test cases to user

## Constraints

- Do NOT skip test case descriptions after build completion
- Always include all tests from integration tests file (if it exists)
- Always format as user-facing instructions (not developer commands)
- Always reference Testing Guidance section in release report when presenting to user

## Configuration

Post-build testing uses paths from `foundation-config.yaml`:

```yaml
orchestration:
  release:
    enabled: true
    directory: "docs/releases/"  # Or configured path
    integration_tests_file: "integration_tests.md"  # Configurable
    release_report_file: "release_report.md"  # Configurable
    testing_section_name: "Testing Guidance"  # Configurable
```

