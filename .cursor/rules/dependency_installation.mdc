---
description: "Ensures agents automatically install required dependencies when needed to fulfill prompts"
globs: ["**/*"]
alwaysApply: true
---

# ⚠️  DO NOT EDIT THIS FILE DIRECTLY
#
# This is a copy of: foundation/agent_instructions/cursor_rules/dependency_installation.mdc
# Source of truth: foundation/agent_instructions/cursor_rules/dependency_installation.mdc
#
# To edit this rule:
# 1. Edit the source file: foundation/agent_instructions/cursor_rules/dependency_installation.mdc
# 2. Run '/setup_cursor_copies' to sync changes
#
# This file will be overwritten when running setup_cursor_copies.

# Dependency Installation Rule

Ensures agents automatically install required dependencies when needed to fulfill prompts.

## Rule

**Always install required dependencies as needed to fulfill prompts.**

When implementing features, fixing bugs, or making changes that require dependencies:

1. **Detect missing dependencies** - Identify when code requires packages, tools, or libraries that are not installed
2. **Install automatically** - Install dependencies without asking for permission
3. **Use appropriate package manager** - Use the correct package manager for the project (npm, yarn, pip, etc.)
4. **Verify installation** - Confirm dependencies are installed and accessible before proceeding

## When This Applies

- When adding new imports that require packages not in `package.json`, `requirements.txt`, or equivalent
- When using tools or commands that require installation (e.g., `npx`, `pip install`)
- When code references libraries that are not currently installed
- When running scripts that depend on external tools
- When setting up development environments

## Agent Actions

### 1. Detect Missing Dependencies

Before implementing code that requires dependencies:

- Check if imports reference packages not in dependency files
- Verify tools/commands are available before use
- Identify missing runtime dependencies

### 2. Install Dependencies

Install using the appropriate method:

**Node.js/TypeScript projects:**
```bash
npm install <package-name>
# or for dev dependencies
npm install --save-dev <package-name>
```

**Python projects:**
```bash
pip install <package-name>
# or
pip install -r requirements.txt
```

**Other package managers:**
- Use the project's configured package manager
- Follow project conventions for dependency management

### 3. Update Dependency Files

After installing:

- Update `package.json`, `requirements.txt`, or equivalent dependency files
- Include version specifications when appropriate
- Separate dev dependencies from production dependencies

### 4. Verify Installation

- Confirm packages are accessible via imports
- Test that tools/commands work as expected
- Ensure no installation errors occurred

### 5. Proceed After Installing

- After installing dependencies, retry the operation that failed (re-run the command or continue the workflow)
- Do not stop and ask the user to run the command; run it again in the same workflow

## Constraints

- **Do NOT ask for permission** - Install dependencies automatically when needed
- **Do NOT skip installation** - If code requires a dependency, install it
- **Use correct package manager** - Follow project conventions (don't mix npm/yarn/pnpm)
- **Update dependency files** - Always update manifest files after installation
- **Handle errors gracefully** - If installation fails, report the error and suggest alternatives

## Examples

### ✅ Correct: Auto-Install Missing Dependency

```typescript
// Agent detects: "express" is imported but not in package.json
// Agent action: npm install express
// Agent updates: package.json with express dependency
```

### ✅ Correct: Install Dev Dependency

```typescript
// Agent detects: "@types/node" needed for TypeScript but not installed
// Agent action: npm install --save-dev @types/node
// Agent updates: package.json devDependencies
```

### ❌ Incorrect: Skip Installation

```typescript
// Agent detects missing dependency but asks: "Should I install express?"
// This violates the rule - install automatically
```

### ❌ Incorrect: Wrong Package Manager

```typescript
// Project uses npm, but agent runs: yarn add express
// This violates project conventions
```

## Integration Points

### Package Managers

- **npm** - `npm install`, `npm install --save-dev`
- **yarn** - `yarn add`, `yarn add --dev`
- **pnpm** - `pnpm add`, `pnpm add -D`
- **pip** - `pip install`, `pip install -r requirements.txt`
- **poetry** - `poetry add`, `poetry add --dev`

### Dependency Files

- `package.json` - Node.js/TypeScript projects
- `package-lock.json` / `yarn.lock` / `pnpm-lock.yaml` - Lock files (auto-updated)
- `requirements.txt` - Python projects
- `pyproject.toml` - Python projects using Poetry
- `Cargo.toml` - Rust projects
- Other project-specific dependency manifests

## Configuration

No configuration needed - this rule applies universally to all projects.

## Related Documents

- `foundation/agent_instructions/cursor_rules/configuration_management.md` - Configuration file placement
- `foundation/agent_instructions/cursor_rules/agent_constraints.md` - General agent constraints
