---
description: "Automatically detects release intent from user patterns and triggers the release creation workflow"
globs: ["**/*"]
alwaysApply: true
---

# ⚠️  DO NOT EDIT THIS FILE DIRECTLY
#
# This is a copy of: foundation/agent_instructions/cursor_rules/release_detection.mdc
# Source of truth: foundation/agent_instructions/cursor_rules/release_detection.mdc
#
# To edit this rule:
# 1. Edit the source file: foundation/agent_instructions/cursor_rules/release_detection.mdc
# 2. Run '/setup_cursor_copies' to sync changes
#
# This file will be overwritten when running setup_cursor_copies.

# Release Detection Rule

**Reference:** `foundation/development/release_workflow.md` — "Release Detection" section

Configuration is read from `foundation-config.yaml`.

## Trigger Patterns

When a user mentions any of the following patterns, automatically detect release intent:

- "new release"
- "internal release"
- "create release"
- "release vX.Y.Z"
- "split out [features] into a [type] release"
- "prior release"
- "pre-MVP release"
- "MCP-focused release"
- "v0.X.Y release"
- Version numbers in release context (e.g., "v1.1.0", "v2.0.0")
- Release-related planning discussions

## Agent Actions

### Step 1: Detection and Confirmation

If context suggests a release (mentions "release", version numbers, "split out", "prior", etc.):

1. **Load configuration:**
   - Read `foundation-config.yaml` to get release settings
   - Check if orchestration.release is enabled
   - Determine release directory structure

2. **Extract release information** from context:
   - Release ID/version (if mentioned, e.g., "v1.0.0", "v1.1.0")
   - Release type hints (internal/external, marketed/not_marketed)
   - Scope hints (what features/FUs are mentioned)

3. **Ask for confirmation:**
   ```
   I see you're requesting a new release. Should I create a release plan in 
   `{configured_releases_directory}/in_progress/{release_id}/` following the release workflow? (yes/no)
   ```
   
   If release ID was detected, include it in the path.

4. **Exception handling:**
   - If user explicitly says "just a spec document" or "specification only" → create a spec document instead
   - If user says "no" → do not proceed with release creation

### Step 2: Execute Release Workflow

**If user confirms (yes):**

1. **Load required documents:**
   - `foundation/development/release_workflow.md` (primary workflow)
   - `foundation/agent_instructions/cursor_commands/create_release.md` (command implementation, or `.cursor/commands/foundation_create_release.md` if symlinked)
   - `foundation/development/feature_unit_workflow.md` (for FU creation, if feature units enabled)
   - Repository-specific execution instructions (if they exist)

2. **Follow the release workflow:**
   - Start at Step 0 (Checkpoint 0) — Release Planning
   - Create release structure in `{configured_releases_directory}/in_progress/{release_id}/`:
     - `release_plan.md`
     - `manifest.yaml`
     - `execution_schedule.md`
     - `integration_tests.md` (if configured)
     - `discovery_plan.yaml` (if discovery enabled in config)
     - `participant_recruitment_log.md` (if discovery enabled)
     - `status.md`

3. Do NOT create standalone specification documents for releases. Releases must follow the release workflow and be created in the configured releases directory.

## Constraints

- Do NOT proceed without user confirmation - always ask before creating release plans
- Do NOT skip the release workflow - always follow `foundation/development/release_workflow.md` process
- Always validate dependencies before generating execution schedule (if feature units enabled)
- Always get user approval at configured checkpoints

## Integration with Commands

This rule complements the explicit `/create_release` command:
- **Rule-based detection:** Triggers automatically when patterns are detected
- **Explicit command:** User can call `/create_release` directly without pattern matching

Both paths lead to the same workflow execution.

