name: "Fix Feature Bug"
description: "Classify and fix a bug using Neotoma’s error protocol."
prompt: |
  Fix a bug in the Neotoma repo.

  1. Identify feature_id from error, path, or context.
  2. Load:
     - docs/context/index.md
    - docs/feature_units/in_progress/{{feature_id}}/{{feature_id}}_spec.md (or docs/feature_units/completed/{{feature_id}}/{{feature_id}}_spec.md if completed)
    - docs/feature_units/in_progress/{{feature_id}}/manifest.yaml (or docs/feature_units/completed/{{feature_id}}/manifest.yaml if completed)
     - docs/feature_units/standards/error_protocol.md
     - docs/subsystems/i18n.md
     - docs/subsystems/accessibility.md

  3. Classify into Class 1, 2, or 3.
  4. Apply correction rules:
     - Class 1: patch code only
     - Class 2: update spec/manifest first, then align code/tests
     - Class 3: update subsystem/architecture docs first, then rebuild
  
  5. Always add a regression test.
  6. Run lint → TEST_CHANGED → subsystems → TEST_ALL.
  
  7. Output:
     - error_class
     - reason
     - corrected files
     - tests added/updated
