{
  "$schema": "https://www.cursor.com/schemas/commands.json",
  "commands": [
    {
      "name": "Dev: Serve Full Stack",
      "description": "Run npm run dev:serve to start HTTP + UI servers with diagnostics",
      "shell": {
        "command": "npm run dev:serve",
        "cwd": ".",
        "env": {
          "NODE_ENV": "development"
        }
      }
    },
    {
      "name": "debug",
      "description": "Run dev-serve in the background, then show the debugging workflow",
      "shell": {
        "command": "bash -lc 'set -euo pipefail; LOG_FILE=\"/tmp/neotoma-dev-serve.log\"; if pgrep -f scripts/dev-serve.js >/dev/null 2>&1; then echo \"[debug] Stopping existing dev-serve instance...\"; pkill -f scripts/dev-serve.js >/dev/null 2>&1 || true; sleep 1; fi; echo \"[debug] Starting dev-serve in background (logs: $LOG_FILE)...\"; nohup npm run dev:serve >\"$LOG_FILE\" 2>&1 & PID=$!; sleep 2; echo \"[debug] dev-serve running with PID $PID. Monitor logs via: tail -f $LOG_FILE\"; cat .cursor/commands/debug.md'"
      }
    },
    {
      "name": "Setup: Copy Env File",
      "description": "Copy .env file from main repository to this worktree",
      "shell": {
        "command": "npm run copy:env"
      }
    },
    {
      "name": "dev-serve",
      "description": "Start the full-stack dev serve orchestration (HTTP + UI servers) with diagnostics and port URLs",
      "user": {
        "documentation": ".cursor/commands/dev-serve.md"
      }
    },
    {
      "name": "Create New Feature Unit",
      "description": "Scaffold a new Feature Unit: spec, manifest, DSL, test dirs.",
      "user": {
        "documentation": ".cursor/commands/create_feature_unit.md"
      }
    },
    {
      "name": "Fix Feature Bug",
      "description": "Classify and fix a bug using Neotoma's error protocol.",
      "user": {
        "documentation": ".cursor/commands/fix_feature_bug.md"
      }
    },
    {
      "name": "Ingestion Flow Development",
      "description": "Design or modify ingestion pipelines: document ingestion, normalization, chunking, embeddings, indexing.",
      "user": {
        "documentation": ".cursor/commands/ingestion_flow.md"
      }
    },
    {
      "name": "Modify Subsystem",
      "description": "Safely modify schema, ingestion, search, vector_ops, auth, i18n, privacy, or accessibility subsystems.",
      "user": {
        "documentation": ".cursor/commands/modify_subsystem.md"
      }
    },
    {
      "name": "Run Feature Workflow",
      "description": "Safely implement or modify a Feature Unit using Neotoma's spec-first development flow.",
      "user": {
        "documentation": ".cursor/commands/run_feature_workflow.md"
      }
    },
    {
      "name": "UI Workflow (DSL → Design → Implementation)",
      "description": "Generate or modify UI for a Feature Unit using the DSL and design constraints.",
      "user": {
        "documentation": ".cursor/commands/ui_workflow.md"
      }
    },
    {
      "name": "Report Error",
      "description": "Report errors for automated resolution. Supports cross-repo reporting to sibling repositories.",
      "user": {
        "documentation": ".cursor/commands/report_error.md"
      }
    },
    {
      "name": "Debug Pending Errors",
      "description": "Check pending error reports and debug/resolve them. Supports cross-repo error queue checking.",
      "user": {
        "documentation": ".cursor/commands/debug_pending_errors.md"
      }
    },
    {
      "name": "Manage Error Debugging",
      "description": "Manage the error debugging automation watcher: start, stop, check status, or view logs.",
      "user": {
        "documentation": ".cursor/commands/manage_error_debugging.md"
      }
    }
  ]
}
